<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>2026 å¾·ç‘ç‘å£«ä¹‹æ—…</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root { --jp-wash: #F8F9F7; --accent: #2C3E50; --highlight: #D4A373; }
        body { background: var(--jp-wash); font-family: "PingFang TC", "Microsoft JhengHei", sans-serif; padding-bottom: 80px; color: #333; }
        .content-section { display: none; padding: 15px; animation: fadeIn 0.3s ease; }
        .content-section.active { display: block; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        .card-custom { background: white; border-radius: 12px; padding: 18px; margin-bottom: 12px; border: none; box-shadow: 0 2px 8px rgba(0,0,0,0.05); }
        .day-label { font-size: 1.1rem; font-weight: bold; border-bottom: 2.5px solid var(--accent); display: inline-block; margin: 15px 0 10px; letter-spacing: 1px; }
        .bottom-nav { position: fixed; bottom: 0; width: 100%; background: white; border-top: 1px solid #EEE; display: flex; justify-content: space-around; padding: 10px 0; z-index: 1000; }
        .nav-item { color: #BBB; text-decoration: none; text-align: center; font-size: 0.7rem; cursor: pointer; flex: 1; }
        .nav-item.active { color: var(--accent); font-weight: bold; }
        .nav-item i { font-size: 1.3rem; display: block; margin-bottom: 3px; }
        .budget-sum { background: var(--accent); color: white; border-radius: 15px; padding: 25px; text-align: center; margin-bottom: 20px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); }
        .btn-nav { background: #333; color: white; border-radius: 50px; font-size: 0.75rem; padding: 6px 15px; text-decoration: none; display: inline-flex; align-items: center; }
        .pack-item { display: flex; align-items: center; justify-content: space-between; border-bottom: 1px solid #f0f0f0; padding: 8px 0; }
        .pack-text { flex-grow: 1; margin-left: 10px; cursor: pointer; font-size: 0.95rem; }
        .pack-text.checked { text-decoration: line-through; color: #aaa; }
/* æ—¥æœŸå°è¦½åˆ— */
        .day-nav-container {
            display: flex; overflow-x: auto; background: white; padding: 12px 10px; gap: 10px;
            position: sticky; top: 0; z-index: 100; border-bottom: 1px solid #eee;
        }
        .day-nav-container::-webkit-scrollbar { display: none; }
        .day-tab {
            flex: 0 0 auto; padding: 8px 15px; border-radius: 10px; background: #f0f0f0;
            color: #666; font-size: 0.8rem; cursor: pointer; transition: 0.3s; border: none;
        }
        .day-tab.active {
            background: var(--accent); color: white; box-shadow: 0 3px 8px rgba(0,0,0,0.15);
        }
        /* è¡Œç¨‹å…§å®¹é¡¯ç¤ºæ§åˆ¶ */
        .day-content { display: none; animation: fadeIn 0.4s ease; }
        .day-content.active { display: block; }
        .time-node { border-left: 2px solid #ddd; margin-left: 10px; padding-left: 20px; position: relative; }
        .time-node::before { 
            content: ''; position: absolute; left: -6px; top: 5px; 
            width: 10px; height: 10px; background: var(--accent); border-radius: 50%; 
        }
    </style>
</head>
<body>

<div class="p-4 text-center bg-white border-bottom">
    <h1 style="font-size: 1.2rem; letter-spacing: 4px; margin:0; font-weight: 300;">EUROPE 2026</h1>
    <small class="text-muted">Germany â€¢ Norway Cruise â€¢ Switzerland</small>
</div>

<div id="itinerary" class="content-section active">
    <div class="day-nav-container">
        <div class="day-tab active" onclick="switchDay('all', this)">ç¸½è¦½</div>
        <div class="day-tab" onclick="switchDay('910', this)">9/10 å‡ºç™¼</div>
        <div class="day-tab" onclick="switchDay('911', this)">9/11 å¾·åœ‹</div>
        <div class="day-tab" onclick="switchDay('912', this)">9/12 éƒµè¼ª</div>
        <div class="day-tab" onclick="switchDay('919', this)">9/19 ç‘å£«</div>
        <div class="day-tab" onclick="switchDay('920', this)">9/20 éµåŠ›å£«</div>
        <div class="day-tab" onclick="switchDay('921', this)">9/21 å¥è¡Œ</div>
        <div class="day-tab" onclick="switchDay('923', this)">9/23 ç­–é¦¬ç‰¹</div>
        <div class="day-tab" onclick="switchDay('927', this)">9/27 è³¦æ­¸</div>
    </div>

    <div id="day-all" class="day-content active">
        <div class="card-custom">
            <h5 class="fw-bold">2026 å¾·ç‘æŒªå£¯éŠ ğŸ‡ªğŸ‡º</h5>
            <p class="small text-muted">é«˜é›„å‡ºç™¼ï¼Œæ©«è·¨å¾·åœ‹ã€æŒªå¨éƒµè¼ªèˆ‡ç‘å£«æ·±åº¦éŠã€‚</p>
            <div class="badge bg-dark">Total 19 Days</div>
        </div>
    </div>

    <div id="day-910" class="day-content">
        <div class="card-custom">
            <h6 class="fw-bold text-primary mb-3">âœˆï¸ å•Ÿç¨‹ (KHH - FRA)</h6>
            <div class="time-node">
                <b>19:10 é«˜é›„ (KHH)</b><br><small>æ­ä¹˜å‰å¾€é¦™æ¸¯ (1h 40m)</small>
            </div>
            <div class="time-node mt-3">
                <b>23:55 é¦™æ¸¯ (HKG)</b><br><small>é•·é€”é£›è¡Œå¾€æ³•è˜­å…‹ç¦ (13h 20m)</small>
            </div>
        </div>
    </div>

    <div id="day-911" class="day-content">
        <div class="card-custom">
            <h6 class="fw-bold text-primary mb-3">ğŸ‡©ğŸ‡ª æŠµé”èˆ‡éµé“ç§»å‹•</h6>
            <div class="time-node">
                <b>07:15 æŠµé”æ³•è˜­å…‹ç¦ (T2)</b>
            </div>
            <div class="time-node mt-3">
                <b>09:41 ICE é«˜éµ</b><br><small>æ³•è˜­å…‹ç¦ â” 15:21 æŠµé”åŸºçˆ¾</small>
            </div>
        </div>
    </div>

    <div id="day-921" class="day-content">
        <div class="card-custom">
            <h6 class="fw-bold text-primary mb-3">ğŸ”ï¸ å°‘å¥³å³°å€ï¼šå…¨æ™¯å¥è¡Œ</h6>
            <p class="small">æº«æ ¹ â” MÃ¤nnlichen â” å°å¤æˆ´å…‹ (ç´„2å°æ™‚)</p>
            <hr>
            <p class="small mb-0">ä¸‹åˆï¼šæ ¼æ—å¾·ç“¦ / First å±±å€æ´»å‹•</p>
        </div>
    </div>
</div>
</div>

<div id="budget" class="content-section">
    <div class="budget-sum">
        <small style="opacity: 0.8; letter-spacing: 1px;">æ—…ç¨‹ç¸½æ”¯å‡ºä¼°ç®— (TWD)</small>
        <div class="h1 my-2">NT$ <span id="total-twd">0</span></div>
        <div class="small" style="font-size:0.75rem; border-top: 1px solid rgba(255,255,255,0.2); padding-top: 10px;">
            CHF: <span id="total-chf">0</span> | EUR: <span id="total-eur">0</span> | HKD: <span id="total-hkd">0</span>
        </div>
    </div>

    <div class="card-custom">
        <div class="d-flex justify-content-between align-items-center mb-2">
            <h6 class="fw-bold m-0">åŒ¯ç‡è¨­å®š</h6>
            <button class="btn btn-sm btn-outline-primary" style="font-size: 0.7rem;" onclick="fetchRates()">
                <i class="fas fa-sync-alt"></i> æ›´æ–°å³æ™‚åŒ¯ç‡
            </button>
        </div>
        <div class="row g-2 mb-3">
            <div class="col-4"><label class="small text-muted">CHFâ”TWD</label><input type="number" id="rate-chf" class="form-control form-control-sm" value="38.5" onchange="render()"></div>
            <div class="col-4"><label class="small text-muted">EURâ”TWD</label><input type="number" id="rate-eur" class="form-control form-control-sm" value="34.2" onchange="render()"></div>
            <div class="col-4"><label class="small text-muted">HKDâ”TWD</label><input type="number" id="rate-hkd" class="form-control form-control-sm" value="4.1" onchange="render()"></div>
        </div>
        <hr>
        <input type="text" id="exp-name" class="form-control form-control-sm mb-2" placeholder="é …ç›® (å¦‚: æ©Ÿå ´æ™šé¤)">
        <div class="input-group input-group-sm mb-2">
            <select id="exp-curr" class="form-select" style="max-width: 85px;"><option>CHF</option><option>EUR</option><option>HKD</option><option>TWD</option></select>
            <input type="number" id="exp-amt" class="form-control" placeholder="é‡‘é¡">
        </div>
        <textarea id="exp-note" class="form-control form-control-sm mb-2" placeholder="å‚™è¨»å…§å®¹"></textarea>
        <button class="btn btn-dark w-100 btn-sm shadow-sm" onclick="addExp()">è¨˜éŒ„é€™ç­†æ”¯å‡º</button>
    </div>
    <div id="exp-list"></div>
    <button class="btn btn-link btn-sm w-100 text-muted mt-4" onclick="clearAll()">æ¸…ç©ºæ‰€æœ‰è¨˜å¸³ç´€éŒ„</button>
</div>
<div id="packing" class="content-section">
    <div class="day-label">ğŸ§³ è¡Œææ¸…å–®</div>
    
    <div class="card-custom mb-3">
        <div class="input-group input-group-sm">
            <input type="text" id="new-cat-input" class="form-control" placeholder="æ–°å¢é¡åˆ¥ (å¦‚ï¼šåŒ–å¦å“)">
            <button class="btn btn-dark" onclick="addNewCategory()">å»ºç«‹åˆ†é¡</button>
        </div>
    </div>

    <div id="pack-list-container"></div>
    
    <button class="btn btn-link btn-sm w-100 text-muted mt-2" onclick="clearCheckedItems()">æ¸…é™¤æ‰€æœ‰å·²å‹¾é¸é …ç›®</button>
</div>
</div>

<div id="info" class="content-section">
    <div class="day-label">ğŸ”— å¿«é€Ÿé€£çµèˆ‡é›»è©±</div>
    <div class="card-custom">
        <h6 class="fw-bold">ç·Šæ€¥é€£çµ¡</h6>
        <p class="small mb-2">å¤–äº¤éƒ¨æ€¥é›£æ•‘åŠ©ï¼š+886-800-085-095</p>
        <hr>
        <h6 class="fw-bold">å¸¸ç”¨é€£çµ</h6>
        <div class="d-grid gap-2">
            <a href="https://www.sbb.ch/en" target="_blank" class="btn btn-sm btn-outline-dark text-start">SBB ç‘å£«åœ‹éµå®˜ç¶²</a>
            <a href="https://www.meteoswiss.admin.ch/" target="_blank" class="btn btn-sm btn-outline-dark text-start">MeteoSwiss ç‘å£«å¤©æ°£</a>
        </div>
    </div>
</div>
<nav class="bottom-nav">
    <div class="nav-item active" onclick="switchTab('itinerary', this)"><i class="fas fa-calendar-alt"></i>è¡Œç¨‹</div>
    <div class="nav-item" onclick="switchTab('info', this)"><i class="fas fa-info-circle"></i>è³‡è¨Š</div>
    <div class="nav-item" onclick="switchTab('budget', this)"><i class="fas fa-wallet"></i>è¨˜å¸³</div>
    <div class="nav-item" onclick="switchTab('packing', this)"><i class="fas fa-check-square"></i>è¡Œæ</div>
    </nav>

<script>
    function switchTab(id, el) {
        document.querySelectorAll('.content-section').forEach(s => s.classList.remove('active'));
        document.getElementById(id).classList.add('active');
        document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
        el.classList.add('active');
        window.scrollTo(0,0);
    }
function switchDay(dayId, el) {
        // 1. åˆ‡æ›æ¨™ç±¤é¡è‰²
        const container = el.parentElement;
        container.querySelectorAll('.day-tab').forEach(t => t.classList.remove('active'));
        el.classList.add('active');

        // 2. åˆ‡æ›é¡¯ç¤ºå…§å®¹
        document.querySelectorAll('.day-content').forEach(c => c.classList.remove('active'));
        const target = document.getElementById('day-' + dayId);
        if (target) target.classList.add('active');
        
        window.scrollTo(0, 0); // æ²å‹•å›é ‚éƒ¨
    }

async function fetchRates() {
        try {
            const res = await fetch('https://open.er-api.com/v6/latest/TWD');
            const data = await res.json();
            if (data && data.rates) {
                // æ›´æ–°è¼¸å…¥æ¡†æ•¸å€¼
                const chfInput = document.getElementById('rate-chf');
                const eurInput = document.getElementById('rate-eur');
                const hkdInput = document.getElementById('rate-hkd');

                if (chfInput) chfInput.value = (1 / data.rates.CHF).toFixed(2);
                if (eurInput) eurInput.value = (1 / data.rates.EUR).toFixed(2);
                if (hkdInput) hkdInput.value = (1 / data.rates.HKD).toFixed(2);
                
                // æˆåŠŸæ›´æ–°å¾Œåªè·³é€™ä¸€å€‹é€šçŸ¥
                alert('åŒ¯ç‡å·²æ›´æ–°ï¼');

                // å˜—è©¦æ¸²æŸ“ç•«é¢ï¼Œå¦‚æœä¸æˆåŠŸï¼ˆä¾‹å¦‚ä¸åœ¨è¨˜å¸³é é¢ï¼‰å°±å®‰éœåœ°è·³éï¼Œä¸è¦å ±éŒ¯
                try {
                    render();
                } catch (renderError) {
                    console.log("ç•«é¢æ¸²æŸ“è·³éï¼Œä½†ä¸å½±éŸ¿åŒ¯ç‡æ›´æ–°");
                }
            }
        } catch (e) {
            // åªæœ‰åœ¨çœŸçš„é€£ä¸åˆ°ç¶²è·¯æˆ– API å£æ‰æ™‚æ‰è·³é€™å€‹
            console.error("API Error:", e);
            alert('ç¶²è·¯é€£ç·šä¸ç©©ï¼Œç„¡æ³•ç²å–å³æ™‚åŒ¯ç‡');
        }
    }    let expenses = JSON.parse(localStorage.getItem('trip_v2026')) || [];

    function addExp() {
        const name = document.getElementById('exp-name').value, amt = document.getElementById('exp-amt').value, curr = document.getElementById('exp-curr').value, note = document.getElementById('exp-note').value;
        if (name && amt) {
            expenses.push({ name, amt: parseFloat(amt), curr, note, id: Date.now() });
            document.getElementById('exp-name').value = ''; document.getElementById('exp-amt').value = ''; document.getElementById('exp-note').value = '';
            render();
        }
    }

try { render(); } catch(e) { console.log(e); }

// --- ç¨ç«‹æ–°å¢åˆ†é¡è¡Œæé‚è¼¯ ---
    let categorizedPack = JSON.parse(localStorage.getItem('trip_pack_cat')) || [];

    // A. æ–°å¢å¤§é¡åˆ¥
    function addNewCategory() {
        const catInput = document.getElementById('new-cat-input');
        const catName = catInput.value.trim();
        if (!catName) return;

        // æª¢æŸ¥æ˜¯å¦é‡è¤‡
        if (categorizedPack.find(c => c.category === catName)) {
            alert("æ­¤é¡åˆ¥å·²å­˜åœ¨");
            return;
        }

        categorizedPack.push({ category: catName, items: [] });
        catInput.value = "";
        renderPackList();
    }

    // B. åœ¨ç‰¹å®šé¡åˆ¥ä¸‹æ–°å¢é …ç›® (é€éå½ˆå‡ºè¦–çª—è©¢å•ï¼Œæ“ä½œæœ€ç›´è¦º)
    function addItemToCat(catIdx) {
        const itemName = prompt(`åœ¨ã€Œ${categorizedPack[catIdx].category}ã€æ–°å¢é …ç›®ï¼š`);
        if (itemName && itemName.trim() !== "") {
            categorizedPack[catIdx].items.push({ text: itemName.trim(), checked: false });
            renderPackList();
        }
    }

    function toggleItem(catIdx, itemIdx) {
        categorizedPack[catIdx].items[itemIdx].checked = !categorizedPack[catIdx].items[itemIdx].checked;
        renderPackList();
    }

    function deleteCategory(catIdx) {
        if(confirm(`ç¢ºå®šè¦åˆªé™¤ã€Œ${categorizedPack[catIdx].category}ã€æ•´å€‹åˆ†é¡å—ï¼Ÿ`)) {
            categorizedPack.splice(catIdx, 1);
            renderPackList();
        }
    }

    function deleteSingleItem(catIdx, itemIdx) {
        categorizedPack[catIdx].items.splice(itemIdx, 1);
        renderPackList();
    }

    function renderPackList() {
        const container = document.getElementById('pack-list-container');
        if (!container) return;
        container.innerHTML = '';

        categorizedPack.forEach((catObj, catIdx) => {
            let catHtml = `
                <div class="card-custom mb-3">
                    <div class="d-flex justify-content-between align-items-center border-bottom pb-2 mb-2">
                        <span class="fw-bold text-primary"># ${catObj.category}</span>
                        <div>
                            <button class="btn btn-sm btn-outline-dark py-0" onclick="addItemToCat(${catIdx})">+ é …ç›®</button>
                            <button class="btn btn-sm text-danger ms-2" onclick="deleteCategory(${catIdx})"><i class="fas fa-trash-alt"></i></button>
                        </div>
                    </div>`;
            
            if (catObj.items.length === 0) {
                catHtml += `<div class="text-center py-2 small text-muted">æš«ç„¡é …ç›®ï¼Œé»æ“Š + æ–°å¢</div>`;
            }

            catObj.items.forEach((item, itemIdx) => {
                catHtml += `
                    <div class="pack-item d-flex align-items-center justify-content-between py-1">
                        <div class="d-flex align-items-center flex-grow-1" onclick="toggleItem(${catIdx}, ${itemIdx})">
                            <input type="checkbox" ${item.checked ? 'checked' : ''}>
                            <span class="pack-text ${item.checked ? 'checked' : ''} ms-2">${item.text}</span>
                        </div>
                        <button class="btn btn-sm text-muted" onclick="deleteSingleItem(${catIdx}, ${itemIdx})">Ã—</button>
                    </div>`;
            });
            
            catHtml += `</div>`;
            container.innerHTML += catHtml;
        });
        localStorage.setItem('trip_pack_cat', JSON.stringify(categorizedPack));
    }

    function clearCheckedItems() {
        if(confirm("ç¢ºå®šè¦æ¸…é™¤æ‰€æœ‰å·²å‹¾é¸çš„é …ç›®å—ï¼Ÿ")) {
            categorizedPack.forEach(cat => {
                cat.items = cat.items.filter(item => !item.checked);
            });
            renderPackList();
        }
    }

    // åˆå§‹åŒ–åŸ·è¡Œ
    renderPackList();
</script>
</body>
</html>
