<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>2026 å¾·ç‘ç‘å£«ä¹‹æ—…</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root { --jp-wash: #F8F9F7; --accent: #2C3E50; --highlight: #D4A373; }
        body { 
    background: var(--jp-wash); 
    /* ä½¿ç”¨æ›´ç¾ä»£çš„å­—é«”é›†ï¼Œå„ªå…ˆèª¿ç”¨ç³»çµ±é è¨­çš„ç„¡è¥¯ç·šå­—é«” */
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, "PingFang TC", "Microsoft JhengHei", sans-serif; 
    padding-bottom: 80px; 
    color: #333; 
    letter-spacing: 0.02em; /* ç¨å¾®å¢åŠ å­—è·ï¼Œæå‡é–±è®€èˆ’é©åº¦ */
}
        .content-section { display: none; padding: 15px; animation: fadeIn 0.3s ease; }
        .content-section.active { display: block; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        .card-custom { background: white; border-radius: 12px; padding: 18px; margin-bottom: 12px; border: none; box-shadow: 0 2px 8px rgba(0,0,0,0.05); }
        .day-label { font-size: 1.1rem; font-weight: bold; border-bottom: 2.5px solid var(--accent); display: inline-block; margin: 15px 0 10px; letter-spacing: 1px; }
        .bottom-nav { position: fixed; bottom: 0; width: 100%; background: white; border-top: 1px solid #EEE; display: flex; justify-content: space-around; padding: 10px 0; z-index: 1000; }
        .nav-item { color: #BBB; text-decoration: none; text-align: center; font-size: 0.7rem; cursor: pointer; flex: 1; }
        .nav-item.active { color: var(--accent); font-weight: bold; }
        .nav-item i { font-size: 1.3rem; display: block; margin-bottom: 3px; }
        .budget-sum { background: var(--accent); color: white; border-radius: 15px; padding: 25px; text-align: center; margin-bottom: 20px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); }
        .btn-nav { background: #333; color: white; border-radius: 50px; font-size: 0.75rem; padding: 6px 15px; text-decoration: none; display: inline-flex; align-items: center; }
        .pack-item { display: flex; align-items: center; justify-content: space-between; border-bottom: 1px solid #f0f0f0; padding: 8px 0; }
        .pack-text { flex-grow: 1; margin-left: 10px; cursor: pointer; font-size: 0.95rem; }
        .pack-text.checked { text-decoration: line-through; color: #aaa; }
/* æ©«å‘å°è¦½å®¹å™¨ */
.day-nav-container {
    display: flex;
    overflow-x: auto;
    background: white;
    padding: 15px 10px;
    gap: 15px;
    position: sticky;
    top: 105px; /* é€™è£¡è¦æ ¹æ“šæ¨™é¡Œæ¬„çš„é«˜åº¦åšèª¿æ•´ï¼Œå¤§ç´„æ˜¯ 100-110px */
    z-index: 999;
    border-bottom: 1px solid #f0f0f0;
    -webkit-overflow-scrolling: touch;
}
        .day-nav-container::-webkit-scrollbar { display: none; }

        /* æ—¥æœŸå¡ç‰‡åŸºç¤æ¨£å¼ */
        .day-tab {
            display: flex;
            flex-direction: column;
            align-items: center;
            flex: 0 0 auto;
            min-width: 50px;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        /* ä¸Šæ’ï¼šæ˜ŸæœŸè‹±æ–‡ */
        .day-tab .day-week {
            font-size: 0.65rem;
            text-transform: uppercase;
            color: #ccc; /* æœªé¸ä¸­ç‚ºæ·ºç°è‰² */
            margin-bottom: 4px;
            letter-spacing: 0.5px;
        }

        /* ä¸‹æ’ï¼šæ—¥æœŸæ•¸å­— */
        .day-tab .day-num {
            font-size: 1.2rem;
            font-weight: 400;
            color: #ddd; /* æœªé¸ä¸­ç‚ºæ·ºç°è‰² */
            position: relative;
            padding-bottom: 8px;
        }

        /* é¸ä¸­ç‹€æ…‹ï¼šæ·±è‰²å¼·èª¿ */
        .day-tab.active .day-week {
            color: #333;
            font-weight: bold;
        }
        .day-tab.active .day-num {
            color: #000;
            font-weight: 700;
        }

        /* é¸ä¸­ç‹€æ…‹ä¸‹æ–¹çš„ç´…é» */
        .day-tab.active .day-num::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 4px;
            height: 4px;
            background-color: #8B0000; /* æ·±ç´…è‰²å°é» */
            border-radius: 50%;
        }
/* ä½å®¿è³‡è¨Šå›ºå®šæ¡† */
/* ä½å®¿è³‡è¨Šå›ºå®šæ¡† */
.accommodation-bar {
    position: fixed;
    bottom: 65px; 
    left: 15px;
    right: 15px;
    background: white;
    padding: 12px 18px;
    border-radius: 12px;
    box-shadow: 0 -4px 15px rgba(0,0,0,0.1);
    z-index: 998;
    display: none; 
    justify-content: space-between;
    align-items: center;
    border: 1px solid #eee;
}

[data-theme="dark"] .accommodation-bar {
    background: #1e1e1e;
    border-color: #333;
}

/* æ ¸å¿ƒä¿®æ­£ï¼šåœ°åœ–æŒ‰éˆ•æ¨£å¼ */
.accommodation-bar .btn-map {
    background-color: #2C3E50 !important; /* å¼·åˆ¶ä½¿ç”¨æ‚¨çš„ä¸»é¡Œæ·±è—è‰² */
    color: #ffffff !important;           /* å¼·åˆ¶æ–‡å­—ç‚ºç™½è‰²ï¼Œé˜²æ­¢è®Šæˆè—è‰²å­— */
    border-radius: 20px;
    font-size: 0.75rem;
    padding: 6px 15px;
    text-decoration: none !important;    /* ç§»é™¤åº•ç·š */
    border: 1px solid #3d5166 !important;
    transition: all 0.2s ease;
    display: inline-flex;
    align-items: center;
}

/* é»æ“Šæ•ˆæœï¼šèˆ‡å…¨ç«™æŒ‰éˆ•ä¸€è‡´ */
.accommodation-bar .btn-map:active {
    transform: translateY(1px) scale(0.95);
    background-color: #1a252f !important; /* é»æ“Šæ™‚è®Šæ·± */
    opacity: 0.9;
}

/* å¤œé–“æ¨¡å¼ä¸‹çš„å¾®èª¿ */
[data-theme="dark"] .accommodation-bar .btn-map {
    background-color: #2C3E50 !important;
    border-color: #455a64 !important;
}
/* --- 1. è¡Œç¨‹å…§å®¹é¡¯ç¤ºæ§åˆ¶ --- */
.day-content { display: none; animation: fadeIn 0.4s ease; }
.day-content.active { display: block; }
/* ğŸŒŸ æ™‚é–“è»¸æ·¡å…¥å‹•ç•«ï¼ˆå–ä»£åŸæœ¬ time-item è¨­å®šï¼‰ */
/* ğŸŒŸ æ™‚é–“è»¸å…±ç”¨åŸºæº–ç·šï¼ˆä¸è¦æ”¹é€™å€‹å€¼ï¼‰ */
:root {
    --timeline-x: 16px;
}
.time-item {
    position: relative;
    padding-left: 32px;
    padding-top: 12px;
    padding-bottom: 24px;

    opacity: 0;
    transform: translateY(6px);
    animation: timelineFade 0.6s ease forwards;
}

/* ğŸŒŸ ç”¨å½å…ƒç´ ç•«ç·šï¼ˆé—œéµï¼‰ */
.time-item::before {
    content: '';
    position: absolute;
    left: 15px;   /* â­ é—œéµ */
    top: 12px;
    bottom: -24px;              /* â­ æ”¹æˆä¸æ˜¯ 0 */
    width: 2px;
    background-color: #ddd;
}
/* æ¯ä¸€ç­†ç¨å¾®éŒ¯é–‹å‡ºç¾ */
.time-item:nth-child(1) { animation-delay: 0.05s; }
.time-item:nth-child(2) { animation-delay: 0.15s; }
.time-item:nth-child(3) { animation-delay: 0.25s; }
.time-item:nth-child(4) { animation-delay: 0.35s; }

/* åœ“é»åŒæ­¥å‹•ç•« */
.time-node {
    position: absolute;
    left: calc(var(--timeline-x) - 6px);
    top: 12px;
    width: 12px;
    height: 12px;
    background-color: var(--accent);
    border-radius: 50%;
    border: 2px solid var(--jp-wash);

    transform: scale(0.6);
    opacity: 0;
    animation: nodePop 0.4s ease forwards;
    animation-delay: inherit;
}

/* æœ€å¾Œä¸€ç­†ä¸ç•«ç·š */
.time-item:last-child::before {
    display: none;
}

/* å‹•ç•«é—œéµå½±æ ¼ */
@keyframes timelineFade {
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

@keyframes nodePop {
    to {
        opacity: 1;
        transform: scale(1);
    }
}
/* å¤œé–“æ¨¡å¼é©é… */
[data-theme="dark"] .time-item::before {
    background-color: #444;
}
[data-theme="dark"] .time-node { 
    background-color: var(--highlight) !important; 
    border-color: #1e1e1e; 
}
/* åŒæ­¥ä¸­å¿ƒå¡ç‰‡æ¨£å¼ */
        .sync-card {
            background: linear-gradient(135deg, #ffffff 0%, #f8f9fa 100%);
            border: 1px dashed #D4A373; /* ä½¿ç”¨ä½ å®šç¾©çš„äº®è‰²ä½œç‚ºé‚Šæ¡† */
            border-radius: 15px;
            padding: 20px;
            margin-top: 20px;
        }
        .btn-sync {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            padding: 12px;
            border-radius: 10px;
            font-size: 0.9rem;
            font-weight: 500;
            transition: all 0.2s;
            width: 100%;
            border: none;
        }
        .btn-export {
            background-color: #2C3E50; /* ä½¿ç”¨ä½ çš„ accent è‰² */
            color: white;
            margin-bottom: 10px;
        }
        .btn-import {
            background-color: white;
            color: #2C3E50;
            border: 1px solid #2C3E50;
        }
        .btn-sync:active {
            transform: scale(0.98);
            opacity: 0.9;
        }
.day-content .text-primary {
    color: #2C3E50 !important; /* <--- æ‚¨å¯ä»¥æŠŠ #2C3E50 æ”¹æˆä»»ä½•æ‚¨æƒ³è¦çš„æ·±è‰² */
}
[data-theme="dark"] .day-content .text-primary {
    color: #D4A373 !important; /* <--- æ‚¨å¯ä»¥æŠŠ #D4A373 æ”¹æˆä»»ä½•æ‚¨æƒ³è¦çš„æ·ºè‰²æˆ–é‡‘æ£•è‰² */
}
[data-theme="dark"] {
    --jp-wash: #121212 !important;
    --accent: #EAEAEA;
    --highlight: #D4A373;
}

[data-theme="dark"] body {
    color: #ddd;
}

[data-theme="dark"] .card-custom,
[data-theme="dark"] .accommodation-bar,
[data-theme="dark"] .sync-card,
[data-theme="dark"] .list-group-item {
    background-color: #1e1e1e !important;
    border: 1px solid #2a2a2a !important;
    box-shadow: 0 2px 8px rgba(0,0,0,0.4) !important;
}

/* ä¿®æ­£å°è¦½åˆ—èˆ‡æ¨™é¡Œ */
[data-theme="dark"] .bottom-nav,
[data-theme="dark"] .day-nav-container {
    background: #1a1a1a !important;
    border-bottom: 1px solid #2a2a2a !important;
    box-shadow: none !important;
}

/* ä¿®æ­£æ–‡å­—é¡è‰² */
[data-theme="dark"] .text-primary {
    color: var(--highlight) !important; /* å°‡åŸæœ¬çš„è—è‰²æ¨™é¡Œæ”¹ç‚ºé‡‘æ£•è‰²ï¼Œæ›´é…å¤œé–“æ¨¡å¼ */
}

[data-theme="dark"] .text-muted {
    color: #888 !important;
}
}

[data-theme="dark"] .text-muted {
    color: #aaa !important;
}

[data-theme="dark"] .budget-sum {
    background: #252525; /* æ”¹ç‚ºæ·±ç°è‰²èƒŒæ™¯ */
    box-shadow: 0 4px 15px rgba(0,0,0,0.4); /* åŠ å¼·é™°å½±æ·±åº¦ */
    border: 1px solid #333; /* å¢åŠ å¾®å¼±é‚Šæ¡†å€éš” */
}

[data-theme="dark"] .day-tab .day-week,
[data-theme="dark"] .day-tab .day-num {
    color: #777;
}

[data-theme="dark"] .day-tab.active .day-week,
[data-theme="dark"] .day-tab.active .day-num {
    color: #fff;
}
/* ğŸŒ™ å¤œé–“æ¨¡å¼ï¼šæ‰€æœ‰æŒ‰éˆ•å…¨ç‹€æ…‹çµ±ä¸€ */

/* A. å¹³æ™‚çš„ç‹€æ…‹ï¼šçµ±ä¸€ç‚ºæ·±è—è‰² */
[data-theme="dark"] .btn-dark, 
[data-theme="dark"] .btn-primary,
[data-theme="dark"] .btn-sync,
[data-theme="dark"] .btn-export,
[data-theme="dark"] .btn-import,
[data-theme="dark"] .btn-outline-primary,
[data-theme="dark"] .btn-outline-dark,
[data-theme="dark"] .btn-info {
    background-color: #2C3E50 !important;
    color: #ffffff !important;
    border: 1px solid #455a64 !important;
    transition: all 0.2s ease !important; /* è®“è®Šè‰²å¹³æ»‘ */
}

/* B. æ‡¸åœ (Hover) èˆ‡ é»æ“Š (Active) çš„ç‹€æ…‹ï¼šçµ±ä¸€è®Šæ·± */
[data-theme="dark"] .btn-dark:hover, [data-theme="dark"] .btn-dark:active,
[data-theme="dark"] .btn-primary:hover, [data-theme="dark"] .btn-primary:active,
[data-theme="dark"] .btn-sync:hover, [data-theme="dark"] .btn-sync:active,
[data-theme="dark"] .btn-export:hover, [data-theme="dark"] .btn-export:active,
[data-theme="dark"] .btn-import:hover, [data-theme="dark"] .btn-import:active,
[data-theme="dark"] .btn-outline-primary:hover, [data-theme="dark"] .btn-outline-primary:active,
[data-theme="dark"] .btn-outline-dark:hover, [data-theme="dark"] .btn-outline-dark:active,
[data-theme="dark"] .btn-info:hover, [data-theme="dark"] .btn-info:active {
    background-color: #1a252f !important; /* é»æ“Šæ™‚è®Šæˆæ›´æ·±çš„è—é»‘è‰² */

    color: #ffffff !important;
    transform: translateY(1px); /* è¼•å¾®ä¸‹æ²ˆæ„Ÿï¼Œæ¨¡æ“¬çœŸå¯¦æŒ‰éˆ• */
}
/* ğŸŒ™ ç°¡ç´„åœ–æ¨™æŒ‰éˆ•ï¼šä¹Ÿè¦æœ‰çµ±ä¸€çš„å›é¥‹æ„Ÿ */
#themeBtn {
    background: transparent !important;
    border: none !important;
    transition: all 0.2s ease;
}

#themeBtn:active {
    transform: scale(0.85); /* é»æ“Šæ™‚ç¸®å°ï¼Œé€™æ˜¯ä¸€å€‹å¾ˆæ£’çš„ç°¡ç´„å›é¥‹æ„Ÿ */
    opacity: 0.7;
}
/* ğŸŒ™ å¤œé–“æ¨¡å¼åˆ‡æ›å‹•ç•« */
body,
.sticky-top,
.card,
.bg-white {
    transition: 
        background-color 0.5s ease,
        color 0.5s ease,
        border-color 0.5s ease;
}
/* ğŸŒ™ æ¨™é¡Œå¤œé–“æ¨¡å¼ */
[data-theme="dark"] .trip-title {
    color: #f1f3f5;
}

[data-theme="dark"] .trip-subtitle {
    color: #adb5bd;
}
/* ğŸŒ™ ä¸»é¡Œåˆ‡æ›æŒ‰éˆ•ä½ç½® */
.theme-toggle {
    position: absolute;
    top: 12px;
    right: 12px;
    z-index: 10;
}
/* ğŸŒ™ Header å¤œé–“èƒŒæ™¯ */
[data-theme="dark"] .sticky-top {
    background-color: #121212 !important;
    border-bottom: 1px solid #2a2a2a !important; /* å°‡åŸæœ¬å¯èƒ½çš„ç™½ç·šæ”¹ç‚ºæ¥µæ·±ç° */
    box-shadow: none !important;
}
[data-theme="dark"] .sticky-top .p-3 {
    background-color: #121212 !important;
}
/* ğŸŒ™ å¤œé–“æ¨¡å¼ï¼æ™‚é˜é¡è‰² */
[data-theme="dark"] #tw-time {
    color: #999 !important;  /* ä½ æ—¥é–“ç”¨çš„æ·ºç°è‰² */
}

/* å¤œé–“æ¨¡å¼ï¼šæ­æ´²æ™‚é–“ä¿ç•™ç™½è‰²æˆ–å†·è‰²å°æ¯” */
[data-theme="dark"] #eu-time {
    color: #f1f3f5 !important;
}
[data-theme="dark"] #tw-date-label,
[data-theme="dark"] #eu-date-label {
    color: #adb5bd !important;
}

[data-theme="dark"] .sticky-top small {
    color: #adb5bd !important;
}
/* ğŸŒ™ å¤œé–“æ¨¡å¼ï¼æ™‚é˜èƒŒæ™¯ */
[data-theme="dark"] .sticky-top .d-flex {
    background-color: #1e1e1e !important;
    border: 1px solid #2a2a2a;
}
/* ğŸŒ™ å¤œé–“æ¨¡å¼ï¼éšŠå‹åŒæ­¥ä¸­å¿ƒå¡ç‰‡ */
[data-theme="dark"] .sync-card {
    background: #1e1e1e;           /* æ”¹ç‚ºæ·±è‰²èƒŒæ™¯ */
    border: 1px dashed #444;       /* é‚Šæ¡†é¡è‰²èª¿æ·± */
    color: #ddd;
}

[data-theme="dark"] .btn-import {
    background-color: #2c2c2c;     /* åŒ¯å…¥æŒ‰éˆ•èƒŒæ™¯è®Šæ·± */
    color: #EAEAEA;                /* æ–‡å­—è®Šäº® */
    border-color: #555;
}
/* ğŸŒ™ å¤œé–“æ¨¡å¼ï¼è¼¸å…¥æ¡†èˆ‡ä¸‹æ‹‰é¸å–® */
[data-theme="dark"] .form-control, 
[data-theme="dark"] .form-select,
[data-theme="dark"] .input-group-text {
    background-color: #2c2c2c !important; /* æ·±ç°è‰²èƒŒæ™¯ */
    border-color: #444 !important;        /* æ·±è‰²é‚Šæ¡† */
    color: #eee !important;               /* äº®è‰²æ–‡å­— */
}

/* ä¿®æ­£è¼¸å…¥æ¡†å…§çš„ placeholder (æç¤ºæ–‡å­—) é¡è‰² */
[data-theme="dark"] .form-control::placeholder {
    color: #777 !important;
}

/* ä¿®æ­£è¡Œææ¸…å–®çš„æ–°å¢é¡åˆ¥æŒ‰éˆ•é‚Šæ¡† */
[data-theme="dark"] .input-group .btn-dark {
    border: 1px solid #444;
}
/* ğŸŒ™ å¤œé–“æ¨¡å¼ï¼è¨˜å¸³ç¸½é¡å¡ç‰‡ */
[data-theme="dark"] .budget-sum {
    background: #1a252f;           /* æ·±è—é»‘è‰² */
    box-shadow: 0 4px 15px rgba(0,0,0,0.5);
}
/* ğŸŒ™ å¤œé–“æ¨¡å¼ï¼æ‰€æœ‰æŒ‰éˆ•çµ±ä¸€ç‚ºæ·±è—è‰²ç³» */
[data-theme="dark"] .btn-dark, 
[data-theme="dark"] .btn-primary,
[data-theme="dark"] .btn-outline-dark,
[data-theme="dark"] .btn-outline-secondary,
[data-theme="dark"] .btn-export,
[data-theme="dark"] .btn-import,
[data-theme="dark"] .btn-sync {
    background-color: #2C3E50 !important; /* åŸæœ¬ã€Œè¨˜éŒ„é€™ç­†æ”¯å‡ºã€çš„æ·±è—è‰² */
    color: #ffffff !important;
    border: 1px solid #3d5166 !important;
}

/* æŒ‰éˆ•é»æ“Šæ™‚çš„å¾®èª¿ */
[data-theme="dark"] .btn:active {
    background-color: #1a252f !important;
}
/* ğŸŒ™ å¤œé–“æ¨¡å¼ï¼è¼¸å…¥æ¡†èˆ‡ä¸‹æ‹‰é¸å–®æ·±è‰²åŒ– */
[data-theme="dark"] .form-control, 
[data-theme="dark"] .form-select {
    background-color: #252525 !important;
    border-color: #444 !important;
    color: #eeeeee !important;
}

/* ä¿®æ­£è¼¸å…¥æ¡†å…§çš„æç¤ºæ–‡å­—é¡è‰² */
[data-theme="dark"] .form-control::placeholder {
    color: #777 !important;
}
/* ğŸŒ™ å¤œé–“æ¨¡å¼ï¼å€å¡ŠèƒŒæ™¯æ·±è‰²åŒ– */
[data-theme="dark"] .sync-card {
    background: #1e1e1e !important;
    border: 1px dashed #2C3E50 !important; /* é‚Šæ¡†ä¹Ÿç”¨æ·±è—è‰² */
}

[data-theme="dark"] .budget-sum {
    background: #1a252f !important; /* æ”¯å‡ºç¸½é¡æ”¹ç‚ºæ›´æ·±ä¸€é»çš„è—é»‘è‰² */
    box-shadow: 0 4px 15px rgba(0,0,0,0.5);
}
/* ğŸŒ— ä¸»é¡Œåˆ‡æ›æŒ‰éˆ•å›ºå®šå°ºå¯¸ */
#themeBtn {
    width: 40px;
    height: 40px;
    padding: 0;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 1.2rem;
    border: none !important; /* å»é™¤é‚Šæ¡† */
    background: transparent !important; /* èƒŒæ™¯é€æ˜ */
    color: #666; /* æ—¥é–“æ¨¡å¼ä½¿ç”¨ä¸­ç°è‰² */
    transition: transform 0.3s ease;
}

[data-theme="dark"] #themeBtn {
    color: #D4A373; /* å¤œé–“æ¨¡å¼ä½¿ç”¨é‡‘æ£•è‰²åœ–æ¨™ */
}

#themeBtn:active {
    transform: scale(0.8); /* é»æ“Šæ™‚çš„ç¸®æ”¾åé¥‹ */
}    
/* å¼·åˆ¶è¡Œææ¸…å–®æ¨™é¡Œä½¿ç”¨ä¸»é¡Œå®šç¾©çš„ accent é¡è‰² */
#pack-list-container .text-primary {
    color: var(--accent) !important;
}

/* ç¢ºä¿å¤œé–“æ¨¡å¼ä¸‹ä¹ŸåŒæ­¥è·Ÿéš¨ä¸»é¡Œè‰² */
[data-theme="dark"] #pack-list-container .text-primary {
    color: var(--highlight) !important;
}
/* è¡Œç¨‹æ¨™é¡Œåˆ—ï¼ˆå¯é»æ“Šï¼‰ */
.time-header {
    display: inline-flex;          /* â­ é—œéµ */
    align-items: center;
    gap: 6px;                      /* æ–‡å­—èˆ‡ç®­é ­è·é›¢ */
    cursor: pointer;
    user-select: none;
}
/* ä¸‹æ‹‰ç®­é ­ */
.toggle-icon {
    font-size: 0.9rem;
    color: #999;
    transition: transform 0.3s ease;
}

/* ç´°ç¯€å…§å®¹ï¼ˆé è¨­æ”¶åˆï¼‰ */
.time-detail {
    max-height: 0;
    overflow: hidden;
    opacity: 0;
    transition: all 0.35s ease;
    margin-left: 0; /* ä¸å½±éŸ¿æ™‚é–“è»¸ */
}

/* å±•é–‹ç‹€æ…‹ */
.time-item.open .time-detail {
    max-height: 300px;   /* è¶³å¤ å¤§å³å¯ */
    opacity: 1;
    margin-top: 8px;
}

/* ç®­é ­æ—‹è½‰ */
.time-item.open .toggle-icon {
    transform: rotate(180deg);
}
/* ğŸ“ å·¦ä¸Šè§’ã€Œä»Šæ—¥ã€æŒ‰éˆ• - ç¨ç«‹æ¨£å¼ */
.today-toggle {
    position: absolute;
    top: 12px;
    left: 12px;
    z-index: 1000; /* ç¢ºä¿åœ¨æœ€ä¸Šå±¤ */
}

#todayBtn {
    width: auto;
    height: 20px;
    padding: 0 10px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
    font-size: 0.6rem;
    letter-spacing: 1px;
    font-weight: 500;
    letter-spacing: 0.4px;
    border-radius: 999px;
    border: 1px solid rgba(0,0,0,0.08);
    background: rgba(255,255,255,0.6);
    backdrop-filter: blur(6px);
    color: #666;
    white-space: nowrap;
    box-shadow: 0 1px 3px rgba(0,0,0,0.08);
    transition: transform 0.15s ease, background 0.2s ease;
    cursor: pointer;
    line-height: 1.1;
}

[data-theme="dark"] #todayBtn {
    background: rgba(255,255,255,0.08);
    border-color: rgba(255,255,255,0.15);
    color: #ddd;
    box-shadow: 0 1px 4px rgba(0,0,0,0.4);
}
#todayBtn:active {
    transform: scale(0.9);
}
/* --- å¼·åˆ¶ä¿®æ­£ï¼šæ¶ˆé™¤å¤œé–“æ¨¡å¼é€£æ¥è™•äº®ç·šèˆ‡é™°å½± --- */

/* 1. é ‚éƒ¨æ¨™é¡Œåˆ—èˆ‡ä¸‹æ–¹å…§å®¹é€£æ¥è™• */

/* 2. æ©«å‘æ—¥æœŸå°è¦½åˆ— (Day Nav) */

/* 3. åº•éƒ¨é ç±¤ (Bottom Nav) èˆ‡ä¸Šæ–¹å…§å®¹é€£æ¥è™• */
[data-theme="dark"] .bottom-nav {
    background: #1a1a1a !important;
    border-top: 1px solid #2a2a2a !important; /* æ¶ˆé™¤åº•éƒ¨ä¸Šæ–¹çš„äº®ç·š */
    box-shadow: 0 -1px 10px rgba(0,0,0,0.5) !important; /* æ”¹ç‚ºæ·±è‰²é™°å½± */
}

/* 4. å¡ç‰‡å…ƒä»¶ (Card) çš„é‚Šæ¡†èˆ‡é€£æ¥è™• */

/* 5. è¡Œææ¸…å–®èˆ‡å…¶ä»–é€£æ¥è™•ç·šæ¢ */
[data-theme="dark"] .pack-item {
    border-bottom: 1px solid #2a2a2a !important;
}

/* 6. ä¿®æ­£ body ç¢ºä¿èƒŒæ™¯é¡è‰²ä¸€è‡´ï¼Œé¿å…æ»‘å‹•æ™‚é‚Šç·£éœ²ç™½ */
</style>
</head>
<body>

<div class="sticky-top bg-white border-bottom shadow-sm">
    <div class="p-3 text-center">
<h1 class="trip-title"
    style="font-size: 1.2rem; letter-spacing: 4px; margin:0; font-weight: 300;">
    SEP 2026 EUROPE
</h1>

<small class="trip-subtitle d-block mb-2"
       style="font-size: 0.75rem;">
    Germany â€¢ Norway Cruise â€¢ Switzerland â€¢ Italy
</small>
        
<div class="d-flex justify-content-center align-items-center gap-3 py-1 position-relative" 
     style="background: #f8f9fa; border-radius: 20px; font-family: monospace; max-width: 280px; margin: 0 auto;">
    
    <!-- å°ç£æ™‚é–“ -->
    <div class="text-end" style="min-width: 100px;">
        <span id="tw-date-label" style="font-size: 0.5rem; color: #dc3545; vertical-align: middle;"></span>
        <span id="tw-time" style="font-size: 0.9rem; font-weight: bold; color: #999;">--:--</span>
        <small style="font-size: 0.5rem; color: #999; display: block; margin-top: -4px;">TAIWAN</small>
    </div>

    <div style="height: 15px; width: 1px; background: #ddd;"></div>

    <!-- æ­æ´²æ™‚é–“ -->
    <div class="text-start" style="min-width: 100px;">
        <span id="eu-time" style="font-size: 0.9rem; font-weight: bold; color: #2C3E50;">--:--</span>
        <span id="eu-date-label" style="font-size: 0.5rem; color: #198754; vertical-align: middle;"></span>
        <small style="font-size: 0.5rem; color: #2C3E50; display: block; margin-top: -4px;">EUROPE</small>
    </div>

    <!-- Today æŒ‰éˆ•å›ºå®šåœ¨å³ä¸‹è§’ -->
    <button id="todayBtn" onclick="jumpToToday()" title="è·³è½‰è‡³ä»Šæ—¥è¡Œç¨‹"
            style="position: absolute; right: -10px; bottom: -5px;">
        Today Â· <span id="todayDate">--/--</span>
    </button>
</div>

<div class="theme-toggle">
<button id="themeBtn"
        class="btn btn-sm btn-outline-secondary"
        onclick="toggleTheme()"
        style="font-size: 0.9rem; line-height: 1;">
    â˜¾
</div>
</button>

</div>
    </div>
</div>
<div id="itinerary" class="content-section active">
    <div class="day-nav-container">
        <div class="day-tab active" onclick="switchDay('all', this)">
            <span class="day-week">ALL</span><span class="day-num">ç¸½è¦½</span>
        </div>
        <div class="day-tab" onclick="switchDay('910', this)"><span class="day-week">THU</span><span class="day-num">10</span></div>
        <div class="day-tab" onclick="switchDay('911', this)"><span class="day-week">FRI</span><span class="day-num">11</span></div>
        <div class="day-tab" onclick="switchDay('912', this)"><span class="day-week">SAT</span><span class="day-num">12</span></div>
        <div class="day-tab" onclick="switchDay('913', this)"><span class="day-week">SUN</span><span class="day-num">13</span></div>
        <div class="day-tab" onclick="switchDay('914', this)"><span class="day-week">MON</span><span class="day-num">14</span></div>
        <div class="day-tab" onclick="switchDay('915', this)"><span class="day-week">TUE</span><span class="day-num">15</span></div>
        <div class="day-tab" onclick="switchDay('916', this)"><span class="day-week">WED</span><span class="day-num">16</span></div>
        <div class="day-tab" onclick="switchDay('917', this)"><span class="day-week">THU</span><span class="day-num">17</span></div>
        <div class="day-tab" onclick="switchDay('918', this)"><span class="day-week">FRI</span><span class="day-num">18</span></div>
        <div class="day-tab" onclick="switchDay('919', this)"><span class="day-week">SAT</span><span class="day-num">19</span></div>
        <div class="day-tab" onclick="switchDay('920', this)"><span class="day-week">SUN</span><span class="day-num">20</span></div>
        <div class="day-tab" onclick="switchDay('921', this)"><span class="day-week">MON</span><span class="day-num">21</span></div>
        <div class="day-tab" onclick="switchDay('922', this)"><span class="day-week">TUE</span><span class="day-num">22</span></div>
        <div class="day-tab" onclick="switchDay('923', this)"><span class="day-week">WED</span><span class="day-num">23</span></div>
        <div class="day-tab" onclick="switchDay('924', this)"><span class="day-week">THU</span><span class="day-num">24</span></div>
        <div class="day-tab" onclick="switchDay('925', this)"><span class="day-week">FRI</span><span class="day-num">25</span></div>
        <div class="day-tab" onclick="switchDay('926', this)"><span class="day-week">SAT</span><span class="day-num">26</span></div>
        <div class="day-tab" onclick="switchDay('927', this)"><span class="day-week">SUN</span><span class="day-num">27</span></div>
        <div class="day-tab" onclick="switchDay('928', this)"><span class="day-week">MON</span><span class="day-num">28</span></div>
    </div>

    <div id="day-all" class="day-content active">
        <div class="card-custom">
            <h5 class="fw-bold">2026 å¾·ç‘æŒªå£¯éŠ ğŸ‡ªğŸ‡º</h5>
            <p class="small text-muted">é«˜é›„å‡ºç™¼ï¼Œæ©«è·¨å¾·åœ‹ã€æŒªå¨éƒµè¼ªèˆ‡ç‘å£«æ·±åº¦éŠã€‚</p>
            <div class="badge bg-dark">Total 19 Days</div>
        </div>
    </div>

<div id="day-910" class="day-content" data-day="910">
    <div class="card-custom">
        <div class="d-flex justify-content-between align-items-center mb-3">
            <h6 class="fw-bold text-primary m-0">å•Ÿç¨‹é£›è¡Œ</h6>
        </div>
        <div class="time-item">
            <div class="time-node"></div>

            <div class="time-header">
                <div class="fw-bold">19:00 é«˜é›„å°æ¸¯æ©Ÿå ´</div>
                <span class="toggle-icon">â–¾</span>
            </div>

            <div class="time-detail">
                <div class="small text-muted">
                    å‡ºå¢ƒã€æº–å‚™èµ·é£›ã€è²´è³“å®¤
                </div>
            </div>
        </div>
        <div class="time-item">
            <div class="time-node"></div>

            <div class="time-header">
                <div class="fw-bold">23:00 æŠµé”é¦™æ¸¯æ©Ÿå ´</div>
                <span class="toggle-icon">â–¾</span>
            </div>

            <div class="time-detail">
                <div class="small text-muted">
                    ç­‰å¾…è½‰æ©Ÿ (Kiel)
                </div>
            </div>
        </div>
    </div> <!-- â­ card-custom -->
</div>     <!-- â­ day-910 -->
<div id="day-911" class="day-content" data-day="911">
    <div class="card-custom">
        <div class="d-flex justify-content-between align-items-center mb-3">
            <h6 class="fw-bold text-primary m-0">ğŸ‡©ğŸ‡ª æŠµé”å¾·åœ‹</h6>
            <div class="d-flex gap-1">
                <a href="https://www.google.com/search?q=Kiel+Weather" target="_blank" class="btn btn-sm btn-outline-dark" style="font-size: 0.65rem; padding: 2px 6px;">
                    <i class="fas fa-sun"></i>
                </a>
                <a href="https://maps.app.goo.gl/9ZfWp6G1P8Ue2SjN8" target="_blank" class="btn btn-sm btn-outline-dark" style="font-size: 0.65rem; padding: 2px 6px;">
                    <i class="fas fa-map-marked-alt"></i>
                </a>
            </div>
        </div>
        <div class="time-item">
            <div class="time-node"></div>

            <div class="time-header">
                <div class="fw-bold">07:15 æŠµé” FRA T2</div>
                <span class="toggle-icon">â–¾</span>
            </div>

            <div class="time-detail">
                <div class="small text-muted">
                    æŠµé”å¾Œé€šé—œã€é ˜å–è¡Œæ
                </div>
            </div>
        </div>
        <div class="time-item">
            <div class="time-node"></div>

            <div class="time-header">
                <div class="fw-bold">09:41 ICE é«˜éµ</div>
                <span class="toggle-icon">â–¾</span>
            </div>

            <div class="time-detail">
                <div class="small text-muted">
                    æ³•è˜­å…‹ç¦ â” 15:21 æŠµé”åŸºçˆ¾ (Kiel)
                </div>
            </div>
        </div>
    </div> <!-- â­ card-custom -->
</div>     <!-- â­ day-911 -->
<div id="day-912" class="day-content" data-day="912">
    <div class="card-custom">
        <div class="d-flex justify-content-between align-items-center mb-3">
            <h6 class="fw-bold text-primary m-0">ğŸš¢ ç™»èˆ¹ï¼šåŸºçˆ¾ Kiel</h6>
            <div class="d-flex gap-1">
                <a href="https://www.yr.no/en" target="_blank" class="btn btn-sm btn-outline-dark" style="font-size: 0.65rem; padding: 2px 6px;">
                    <i class="fas fa-sun"></i>
                </a>
                <a href="https://maps.app.goo.gl/xjPNo9XXZtwXu1qR7" target="_blank" class="btn btn-sm btn-outline-dark" style="font-size: 0.65rem; padding: 2px 6px;">
                    <i class="fas fa-map-marked-alt"></i>
                </a>
            </div>
        </div>
        <div class="time-item">
            <div class="time-node"></div>

            <div class="time-header">
                <div class="fw-bold">16:00 MSC EURIBIAç™»èˆ¹</div>
                <span class="toggle-icon">â–¾</span>
            </div>

            <div class="time-detail">
                <div class="small text-muted">
                    Terminal MSC Kiel 
                </div>
            </div>
        </div>
        <div class="time-item">
            <div class="time-node"></div>

            <div class="time-header">
                <div class="fw-bold">19:00 å•Ÿèˆª</div>
                <span class="toggle-icon">â–¾</span>
            </div>

            <div class="time-detail">
                <div class="small text-muted">
                    æˆ¿è™Ÿ10103
                </div>
            </div>
        </div>
    </div> <!-- â­ card-custom -->
</div>     <!-- â­ day-912 -->
    <div id="day-913" class="day-content" data-day="913"><div class="card-custom"><h6 class="fw-bold text-primary mb-3">ğŸš¢ å“¥æœ¬å“ˆæ ¹</h6><div class="time-item"><div class="time-node"></div><div class="fw-bold">éƒµè¼ªèˆªè¡Œä¸­</div></div></div></div>
    <div id="day-914" class="day-content" data-day="914"><div class="card-custom"><h6 class="fw-bold text-primary mb-3">ğŸš¢ æµ·ä¸Šå·¡èˆª</h6><div class="time-item"><div class="time-node"></div><div class="fw-bold">éƒµè¼ªèˆªè¡Œä¸­</div></div></div></div>
    <div id="day-915" class="day-content" data-day="915"><div class="card-custom"><h6 class="fw-bold text-primary mb-3">ğŸš¢ å¸Œé›·æ–¯åˆ©ç‰¹</h6><div class="time-item"><div class="time-node"></div><div class="fw-bold">éƒµè¼ªèˆªè¡Œä¸­</div></div></div></div>
    <div id="day-916" class="day-content" data-day="916"><div class="card-custom"><h6 class="fw-bold text-primary mb-3">ğŸš¢ å¥§å‹’æ¾</h6><div class="time-item"><div class="time-node"></div><div class="fw-bold">éƒµè¼ªèˆªè¡Œä¸­</div></div></div></div>
    <div id="day-917" class="day-content" data-day="917"><div class="card-custom"><h6 class="fw-bold text-primary mb-3">ğŸš¢ å¼—æ´›å§†</h6><div class="time-item"><div class="time-node"></div><div class="fw-bold">éƒµè¼ªèˆªè¡Œä¸­</div></div></div></div>
    <div id="day-918" class="day-content" data-day="918"><div class="card-custom"><h6 class="fw-bold text-primary mb-3">ğŸš¢ æµ·ä¸Šå·¡èˆª</h6><div class="time-item"><div class="time-node"></div><div class="fw-bold">éƒµè¼ªèˆªè¡Œä¸­</div></div></div></div>
<div id="day-919" class="day-content" data-day="919">
    <div class="card-custom">
        <div class="d-flex justify-content-between align-items-center mb-3">
            <h6 class="fw-bold text-primary m-0">ğŸ‡¨ğŸ‡­ ç‰æ£® Luzern</h6>
            <div class="d-flex gap-1">
                <a href="https://www.meteoswiss.admin.ch/local-forecasts/lucerne/6000.html" target="_blank" class="btn btn-sm btn-outline-dark" style="font-size: 0.65rem; padding: 2px 6px;">
                    <i class="fas fa-sun"></i>
                </a>
                <a href="(åœ°åœ–é€£çµ)" target="_blank" class="btn btn-sm btn-outline-dark" style="font-size: 0.65rem; padding: 2px 6px;">
                    <i class="fas fa-map-marked-alt"></i>
                </a>
            </div>
        </div>
        <div class="time-item"><div class="time-node"></div><div class="fw-bold">æŠµé”ç‰æ£®</div><div class="small text-muted">å¸‚å€è§€å…‰ã€å¡è²çˆ¾æ©‹</div></div>
    </div>
</div>

<div id="day-920" class="day-content" data-day="920">
    <div class="card-custom">
        <div class="d-flex justify-content-between align-items-center mb-3">
            <h6 class="fw-bold text-primary m-0">ğŸ‡¨ğŸ‡­ å°‘å¥³å³°å€ï¼šæº«æ ¹ Wengen</h6>
            <div class="d-flex gap-1">
                <a href="https://www.meteoswiss.admin.ch/local-forecasts/wengen/3823.html" target="_blank" class="btn btn-sm btn-outline-dark" style="font-size: 0.65rem; padding: 2px 6px;">
                    <i class="fas fa-sun"></i>
                </a>
                <a href="(åœ°åœ–é€£çµ)" target="_blank" class="btn btn-sm btn-outline-dark" style="font-size: 0.65rem; padding: 2px 6px;">
                    <i class="fas fa-map-marked-alt"></i>
                </a>
            </div>
        </div>
        <div class="time-item"><div class="time-node"></div><div class="fw-bold">å…¥ä½ Wengen</div><div class="small text-muted">å°‘å¥³å³°ã€å°å¤æˆ´å…‹</div></div>
    </div>
</div>
    <div id="day-921" class="day-content" data-day="921">
        <div class="card-custom">
            <h6 class="fw-bold text-primary mb-3">ğŸ”ï¸ å¥è¡Œï¼šMÃ¤nnlichen â” å°å¤æˆ´å…‹</h6>
            <div class="time-item"><div class="time-node"></div><div class="fw-bold">å…¨æ™¯å¥è¡Œ (2h)</div><div class="small text-muted">æ ¼æ—å¾·ç“¦ â” First å±±</div></div>
        </div>
    </div>
    <div id="day-922" class="day-content" data-day="922">
        <div class="card-custom">
            <h6 class="fw-bold text-primary mb-3">ğŸ”ï¸ é›ªæœ—å³° (Schilthorn)</h6>
            <div class="time-item"><div class="time-node"></div><div class="fw-bold">æ™¯é»æ¢ç´¢</div><div class="small text-muted">æˆ–å‰å¾€å„è¥¿å«©æ¹– (Oeschinensee)ã€‚å®¿æº«æ ¹</div></div>
        </div>
    </div>
<div id="day-923" class="day-content" data-day="923">
    <div class="card-custom">
        <div class="d-flex justify-content-between align-items-center mb-3">
            <h6 class="fw-bold text-primary m-0">ğŸ‡¨ğŸ‡­ ç­–é¦¬ç‰¹ Zermatt</h6>
            <div class="d-flex gap-1">
                <a href="https://www.meteoswiss.admin.ch/local-forecasts/zermatt/3920.html" target="_blank" class="btn btn-sm btn-outline-dark" style="font-size: 0.65rem; padding: 2px 6px;">
                    <i class="fas fa-sun"></i>
                </a>
                <a href="(åœ°åœ–é€£çµ)" target="_blank" class="btn btn-sm btn-outline-dark" style="font-size: 0.65rem; padding: 2px 6px;">
                    <i class="fas fa-map-marked-alt"></i>
                </a>
            </div>
        </div>
        <div class="time-item"><div class="time-node"></div><div class="fw-bold">äº”æ¹–å¥è¡Œ / å†°å·å¤©å ‚</div></div>
    </div>
</div>
    <div id="day-924" class="day-content" data-day="924">
        <div class="card-custom">
            <h6 class="fw-bold text-primary mb-3">ğŸ—» å†°å·å¤©å ‚ (Glacier Paradise)</h6>
            <div class="time-item"><div class="time-node"></div><div class="fw-bold">æ™¯é»éŠè¦½</div><div class="small text-muted">ç­–é¦¬ç‰¹å‘¨é‚Šæ™¯é»æ¢ç´¢</div></div>
        </div>
    </div>
    <div id="day-925" class="day-content" data-day="925">
        <div class="card-custom">
            <h6 class="fw-bold text-primary mb-3">ğŸ—» ç­–é¦¬ç‰¹å‘¨é‚Š</h6>
            <div class="time-item"><div class="time-node"></div><div class="fw-bold">äº”æ¹–å¥è¡Œ</div><div class="small text-muted">Sunnegga äº”æ¹–å¥è¡Œæˆ–é®ä¸Šæ”¾é¬†</div></div>
        </div>
    </div>
<div id="day-926" class="day-content" data-day="926">
    <div class="card-custom">
        <div class="d-flex justify-content-between align-items-center mb-3">
            <h6 class="fw-bold text-primary m-0">ğŸ‡®ğŸ‡¹ ç±³è˜­ Milan</h6>
            <div class="d-flex gap-1">
                <a href="https://www.google.com/search?q=Milan+Weather" target="_blank" class="btn btn-sm btn-outline-dark" style="font-size: 0.65rem; padding: 2px 6px;">
                    <i class="fas fa-sun"></i>
                </a>
                <a href="(åœ°åœ–é€£çµ)" target="_blank" class="btn btn-sm btn-outline-dark" style="font-size: 0.65rem; padding: 2px 6px;">
                    <i class="fas fa-map-marked-alt"></i>
                </a>
            </div>
        </div>
        <div class="time-item"><div class="time-node"></div><div class="fw-bold">ç±³è˜­å¤§æ•™å ‚ / è³¼ç‰©</div></div>
    </div>
</div>
    <div id="day-927" class="day-content" data-day="927">
        <div class="card-custom">
            <h6 class="fw-bold text-primary mb-3">âœˆï¸ è³¦æ­¸ (MXP - HKG)</h6>
            <div class="time-item"><div class="time-node"></div><div class="fw-bold">12:45 ç±³è˜­ (MXP) èµ·é£›</div><div class="small text-muted">å‰å¾€é¦™æ¸¯ (11h 40m)</div></div>
        </div>
    </div>
    <div id="day-928" class="day-content" data-day="928">
        <div class="card-custom">
            <h6 class="fw-bold text-primary mb-3">ğŸ  æŠµé”é«˜é›„</h6>
            <div class="time-item"><div class="time-node"></div><div class="fw-bold">06:25 æŠµé”é¦™æ¸¯ (HKG)</div></div>
            <div class="time-item"><div class="time-node"></div><div class="fw-bold">08:35 é¦™æ¸¯ â” 10:15 é«˜é›„</div></div>
        </div>
    </div>
</div> 

<div id="budget" class="content-section">
    <div class="budget-sum">
        <small style="opacity: 0.8; letter-spacing: 1px;">æ—…ç¨‹ç¸½æ”¯å‡ºä¼°ç®— (TWD)</small>
        <div class="h1 my-2">NT$ <span id="total-twd">0</span></div>
        <div class="small" style="font-size:0.75rem; border-top: 1px solid rgba(255,255,255,0.2); padding-top: 10px;">
            CHF: <span id="total-chf">0</span> | EUR: <span id="total-eur">0</span> | HKD: <span id="total-hkd">0</span>
        </div>
    </div>

    <div class="card-custom">
        <div class="d-flex justify-content-between align-items-center mb-2">
            <h6 class="fw-bold m-0">åŒ¯ç‡è¨­å®š</h6>
            <button class="btn btn-sm btn-outline-dark" style="font-size: 0.7rem;" onclick="fetchRates()">
                <i class="fas fa-sync-alt"></i> 
            </button>
        </div>
        <div class="row g-2 mb-3">
            <div class="col-4"><label class="small text-muted">CHFâ”TWD</label><input type="number" id="rate-chf" class="form-control form-control-sm" value="38.5" onchange="render()"></div>
            <div class="col-4"><label class="small text-muted">EURâ”TWD</label><input type="number" id="rate-eur" class="form-control form-control-sm" value="34.2" onchange="render()"></div>
            <div class="col-4"><label class="small text-muted">HKDâ”TWD</label><input type="number" id="rate-hkd" class="form-control form-control-sm" value="4.1" onchange="render()"></div>
        </div>
        <hr>
        <input type="text" id="exp-name" class="form-control form-control-sm mb-2" placeholder="é …ç›® (å¦‚: æ©Ÿå ´æ™šé¤)">
        <div class="input-group input-group-sm mb-2">
            <select id="exp-curr" class="form-select" style="max-width: 85px;"><option>CHF</option><option>EUR</option><option>HKD</option><option>TWD</option></select>
            <input type="number" id="exp-amt" class="form-control" placeholder="é‡‘é¡">
        </div>
        <textarea id="exp-note" class="form-control form-control-sm mb-2" placeholder="å‚™è¨»å…§å®¹"></textarea>
        <button class="btn btn-dark w-100 btn-sm shadow-sm" onclick="addExp()">è¨˜éŒ„é€™ç­†æ”¯å‡º</button>
    </div>
    <div id="exp-list"></div>
    <button class="btn btn-link btn-sm w-100 text-muted mt-4" onclick="clearAll()">æ¸…ç©ºæ‰€æœ‰è¨˜å¸³ç´€éŒ„</button>
</div>
<div id="packing" class="content-section">
    <div class="day-label">ğŸ§³ è¡Œææ¸…å–®</div>
    <div class="card-custom mb-3" id="packing-progress-container" style="display: none;">
    <div class="d-flex justify-content-between mb-1">
        <span class="small fw-bold">æ‰“åŒ…é€²åº¦</span>
        <span class="small text-muted" id="packing-percent">0%</span>
    </div>
    <div class="progress" style="height: 8px; background-color: #eee; border-radius: 4px;">
        <div id="packing-bar" class="progress-bar" style="width: 0%; height: 100%; transition: width 0.3s; background-color: #5d8aa8;">
</div>
    </div>
</div>
    <div class="card-custom mb-3">
        <div class="input-group input-group-sm">
            <input type="text" id="new-cat-input" class="form-control" placeholder="æ–°å¢é¡åˆ¥ (å¦‚ï¼šåŒ–å¦å“)">
            <button class="btn btn-dark" onclick="addNewCategory()">å»ºç«‹åˆ†é¡</button>
        </div>
    </div>

    <div id="pack-list-container"></div>
    
    <button class="btn btn-link btn-sm w-100 text-muted mt-2" onclick="clearCheckedItems()">æ¸…é™¤æ‰€æœ‰å·²å‹¾é¸é …ç›®</button>
</div>
</div>

<div id="info" class="content-section">
    <div class="day-label">ğŸ”— å¿«é€Ÿé€£çµèˆ‡é›»è©±</div>
    <div class="card-custom">
        <h6 class="fw-bold">ç·Šæ€¥é€£çµ¡</h6>
        <p class="small mb-2">å¤–äº¤éƒ¨æ€¥é›£æ•‘åŠ©ï¼š+886-800-085-095</p>
        <hr>
        <h6 class="fw-bold">å¸¸ç”¨é€£çµ</h6>
        <div class="d-grid gap-2">
            <a href="https://www.sbb.ch/en" target="_blank" class="btn btn-sm btn-outline-dark text-start">SBB ç‘å£«åœ‹éµå®˜ç¶²</a>
            <a href="https://www.meteoswiss.admin.ch/" target="_blank" class="btn btn-sm btn-outline-dark text-start">MeteoSwiss ç‘å£«å¤©æ°£</a>
        </div>
    </div>

    <div class="sync-card">
        <div class="text-center mb-3">
            <h6 class="fw-bold mb-1"> éšŠå‹åŒæ­¥ä¸­å¿ƒ</h6>
            <small class="text-muted">åŒæ­¥è¨˜å¸³ç´€éŒ„èˆ‡è¡Œææ¸…å–®</small>
        </div>
        <button class="btn-sync btn-export" onclick="exportData()">
            <i class="fas fa-share-square"></i> åŒ¯å‡ºä¸¦è¤‡è£½æ•¸æ“šä»£ç¢¼
        </button>
        <button class="btn-sync btn-import" onclick="importData()">
            <i class="fas fa-file-import"></i> è²¼ä¸Šæœ‹å‹çš„ä»£ç¢¼åŒæ­¥
        </button>
        <div class="text-center mt-2">
            <small style="font-size: 0.65rem; color: #999;">æ³¨æ„ï¼šåŒæ­¥æœƒè¦†è“‹æ‰ç›®å‰çš„æœ¬åœ°æ•¸æ“š</small>
        </div>
    </div>
</div>
<nav class="bottom-nav">
    <div class="nav-item active" onclick="switchTab('itinerary', this)"><i class="fas fa-calendar-alt"></i>è¡Œç¨‹</div>
    <div class="nav-item" onclick="switchTab('info', this)"><i class="fas fa-info-circle"></i>è³‡è¨Š</div>
    <div class="nav-item" onclick="switchTab('budget', this)"><i class="fas fa-wallet"></i>è¨˜å¸³</div>
    <div class="nav-item" onclick="switchTab('packing', this)"><i class="fas fa-check-square"></i>è¡Œæ</div>
    <div class="nav-item" onclick="switchTab('favorites', this)"><i class="fas fa-heart"></i>æ”¶è—</div>
    </nav>
<div id="favorites" class="content-section">
<div id="fav-top-container" class="mb-3">
    <h5>ğŸ”– è‡¨æ™‚æ±ºç­–æ¨™è¨˜</h5>
    <div id="fav-top-list"></div>
</div>

<div id="fav-list-container"></div>

<button class="btn btn-sm btn-primary mt-2" onclick="addFavoritePrompt()">â• æ–°å¢å¤§æ¨™é¡Œæ”¶è—</button>

    <div id="fav-list-container"></div>
</div>
</div>
<script>
function updateClocks() {
    const now = new Date();
    
    // 1. èª¿æ•´æ ¼å¼ï¼šåŠ å…¥ second: '2-digit' ä¾†é¡¯ç¤ºç§’æ•¸
    const options = { hour: '2-digit', minute: '2-digit', second: '2-digit', hour12: false };
    
    // 2. ç²å–æ™‚é–“å­—ä¸²
    const twStr = now.toLocaleTimeString('zh-TW', { ...options, timeZone: 'Asia/Taipei' });
    const euStr = now.toLocaleTimeString('zh-TW', { ...options, timeZone: 'Europe/Berlin' });
    
    // 3. ç²å–æ—¥æœŸæ•¸å­—åˆ¤æ–·è·¨æ—¥ (ä½¿ç”¨ Intl.DateTimeFormat è¼ƒç‚ºç©©å®š)
    const twDay = parseInt(new Intl.DateTimeFormat('en-US', { day: 'numeric', timeZone: 'Asia/Taipei' }).format(now));
    const euDay = parseInt(new Intl.DateTimeFormat('en-US', { day: 'numeric', timeZone: 'Europe/Berlin' }).format(now));

    // 4. æ›´æ–° DOM (åŠ ä¸Šå®‰å…¨æª¢æŸ¥ç¢ºä¿ ID å­˜åœ¨)
    const twTimeEl = document.getElementById('tw-time');
    const euTimeEl = document.getElementById('eu-time');
    const twLabel = document.getElementById('tw-date-label');
    const euLabel = document.getElementById('eu-date-label');

    if (twTimeEl) twTimeEl.innerText = twStr;
    if (euTimeEl) euTimeEl.innerText = euStr;

    // 5. åˆ¤æ–·æ—¥æœŸå·®ç•°æ¨™ç±¤
    if (twLabel && euLabel) {
        if (twDay > euDay) {
            twLabel.innerText = "æ˜å¤© "; 
            euLabel.innerText = "";
        } else if (twDay < euDay) {
            twLabel.innerText = "";
            euLabel.innerText = " (æ˜¨æ—¥)"; 
        } else {
            twLabel.innerText = "";
            euLabel.innerText = "";
        }
    }
}

// --- é—œéµï¼šç¢ºä¿é€™è¡Œåœ¨å‡½æ•¸å¤–é¢ï¼Œé€™æ‰æœƒæ¯ç§’åŸ·è¡Œä¸€æ¬¡ ---
setInterval(updateClocks, 1000);
// --- åŸºç¤åˆ†é åˆ‡æ› ---
function switchTab(id, el) {
    document.querySelectorAll('.content-section').forEach(s => s.classList.remove('active'));
    document.getElementById(id).classList.add('active');
    document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
    el.classList.add('active');
    window.scrollTo(0,0);
// ã€æ–°å¢æŒ‡ä»¤ã€‘ï¼šæ¯ç•¶åˆ‡æ›å¤§åˆ†é æ™‚ï¼Œå¼·åˆ¶é‡æ–°åˆ¤å®šä½å®¿æ¡†
    if (typeof refreshHotelBar === 'function') {
        refreshHotelBar();
    }
}

function switchDay(dayId, el) {
    const container = el.parentElement;
    container.querySelectorAll('.day-tab').forEach(t => t.classList.remove('active'));
    el.classList.add('active');
    document.querySelectorAll('.day-content').forEach(c => c.classList.remove('active'));
    const target = document.getElementById('day-' + dayId);
    if (target) target.classList.add('active');
    window.scrollTo(0, 0);
}

// --- è¨˜å¸³é‚è¼¯ ---
let expenses = JSON.parse(localStorage.getItem('trip_v2026')) || [];

function addExp() {
    const name = document.getElementById('exp-name').value;
    const amt = document.getElementById('exp-amt').value;
    const curr = document.getElementById('exp-curr').value;
    const note = document.getElementById('exp-note').value;
    
    if (name && amt) {
        expenses.push({ name, amt: parseFloat(amt), curr, note, id: Date.now() });
        document.getElementById('exp-name').value = ''; 
        document.getElementById('exp-amt').value = ''; 
        document.getElementById('exp-note').value = '';
        render(); // é‡æ–°æ¸²æŸ“
    } else {
        alert("è«‹è¼¸å…¥é …ç›®åç¨±èˆ‡é‡‘é¡");
    }
}

function deleteExp(id) {
    expenses = expenses.filter(e => e.id !== id);
    render();
}

function clearAll() {
    if(confirm("ç¢ºå®šè¦æ¸…ç©ºæ‰€æœ‰è¨˜å¸³ç´€éŒ„å—ï¼Ÿ")) {
        expenses = [];
        render();
    }
}

// æ ¸å¿ƒä¿®æ­£ï¼šè£œå› render å‡½æ•¸
function render() {
    localStorage.setItem('trip_v2026', JSON.stringify(expenses));
    
    const rCHF = parseFloat(document.getElementById('rate-chf').value) || 0;
    const rEUR = parseFloat(document.getElementById('rate-eur').value) || 0;
    const rHKD = parseFloat(document.getElementById('rate-hkd').value) || 0;
    
    let tTWD = 0, tCHF = 0, tEUR = 0, tHKD = 0;
    let html = '';

    expenses.forEach(e => {
        let twd = 0;
        if (e.curr === 'CHF') { twd = e.amt * rCHF; tCHF += e.amt; }
        else if (e.curr === 'EUR') { twd = e.amt * rEUR; tEUR += e.amt; }
        else if (e.curr === 'HKD') { twd = e.amt * rHKD; tHKD += e.amt; }
        else { twd = e.amt; }
        tTWD += twd;

        html += `
            <div class="card-custom mb-2">
                <div class="d-flex justify-content-between">
                    <div>
                        <span class="fw-bold">${e.name}</span>
                        <div class="small text-muted">${Number(e.amt).toLocaleString(undefined, {minimumFractionDigits: 0, maximumFractionDigits: 1})} ${e.curr}<i class="fas fa-arrow-right mx-1"></i> NT$ ${Math.round(twd).toLocaleString()}
</div>
                        ${e.note ? `<div class="small text-secondary mt-1">${e.note}</div>` : ''}
                    </div>
                    <button class="btn btn-sm text-danger" onclick="deleteExp(${e.id})"><i class="fas fa-trash-alt"></i></button>
                </div>
            </div>`;
    });

    document.getElementById('exp-list').innerHTML = html;
    document.getElementById('total-twd').innerText = Math.round(tTWD).toLocaleString();
    document.getElementById('total-chf').innerText = tCHF.toFixed(1);
    document.getElementById('total-eur').innerText = tEUR.toFixed(1);
    document.getElementById('total-hkd').innerText = tHKD.toFixed(1);
}

// --- åŒ¯ç‡ç²å– ---
async function fetchRates() {
    try {
        const res = await fetch('https://open.er-api.com/v6/latest/TWD');
        const data = await res.json();
        if (data && data.rates) {
            document.getElementById('rate-chf').value = (1 / data.rates.CHF).toFixed(2);
            document.getElementById('rate-eur').value = (1 / data.rates.EUR).toFixed(2);
            document.getElementById('rate-hkd').value = (1 / data.rates.HKD).toFixed(2);
            alert('åŒ¯ç‡å·²æ›´æ–°ï¼');
            render();
        }
    } catch (e) {
        alert('ç„¡æ³•ç²å–å³æ™‚åŒ¯ç‡');
    }
}

// --- è¡Œææ¸…å–®é‚è¼¯ ---
let categorizedPack = JSON.parse(localStorage.getItem('trip_pack_cat')) || [];

function addNewCategory() {
    const catInput = document.getElementById('new-cat-input');
    const catName = catInput.value.trim();
    if (!catName) return;
    if (categorizedPack.find(c => c.category === catName)) { alert("æ­¤é¡åˆ¥å·²å­˜åœ¨"); return; }
    categorizedPack.push({ category: catName, items: [] });
    catInput.value = "";
    renderPackList();
}

function addItemToCat(catIdx) {
    const itemName = prompt(`åœ¨ã€Œ${categorizedPack[catIdx].category}ã€æ–°å¢é …ç›®ï¼š`);
    if (itemName && itemName.trim() !== "") {
        categorizedPack[catIdx].items.push({ text: itemName.trim(), checked: false });
        renderPackList();
    }
}

function toggleItem(catIdx, itemIdx) {
    categorizedPack[catIdx].items[itemIdx].checked = !categorizedPack[catIdx].items[itemIdx].checked;
    renderPackList();
}

function deleteCategory(catIdx) {
    if(confirm(`ç¢ºå®šè¦åˆªé™¤ã€Œ${categorizedPack[catIdx].category}ã€æ•´å€‹åˆ†é¡å—ï¼Ÿ`)) {
        categorizedPack.splice(catIdx, 1);
        renderPackList();
    }
}

function deleteSingleItem(catIdx, itemIdx) {
    categorizedPack[catIdx].items.splice(itemIdx, 1);
    renderPackList();
}

function renderPackList() {
    const container = document.getElementById('pack-list-container');
    if (!container) return;
    container.innerHTML = '';
    categorizedPack.forEach((catObj, catIdx) => {
        let catHtml = `<div class="card-custom mb-3">
            <div class="d-flex justify-content-between align-items-center border-bottom pb-2 mb-2">
                <span class="fw-bold text-primary"># ${catObj.category}</span>
                <div>
                    <button class="btn btn-sm btn-outline-dark py-0" onclick="addItemToCat(${catIdx})">+ é …ç›®</button>
                    <button class="btn btn-sm text-danger ms-2" onclick="deleteCategory(${catIdx})"><i class="fas fa-trash-alt"></i></button>
                </div>
            </div>`;
        if (catObj.items.length === 0) {
            catHtml += `<div class="text-center py-2 small text-muted">æš«ç„¡é …ç›®</div>`;
        }
        catObj.items.forEach((item, itemIdx) => {
            catHtml += `<div class="pack-item d-flex align-items-center justify-content-between py-1">
                <div class="d-flex align-items-center flex-grow-1" onclick="toggleItem(${catIdx}, ${itemIdx})">
                    <input type="checkbox" ${item.checked ? 'checked' : ''}>
                    <span class="pack-text ${item.checked ? 'checked' : ''} ms-2">${item.text}</span>
                </div>
                <button class="btn btn-sm text-muted" onclick="deleteSingleItem(${catIdx}, ${itemIdx})">Ã—</button>
            </div>`;
        });
        catHtml += `</div>`;
        container.innerHTML += catHtml;
    });
// --- æ–°å¢ï¼šè¨ˆç®—é€²åº¦æ¢é‚è¼¯ ---
let totalItems = 0;
let checkedItems = 0;

categorizedPack.forEach(cat => {
    cat.items.forEach(item => {
        totalItems++;
        if (item.checked) checkedItems++;
    });
});

const progressContainer = document.getElementById('packing-progress-container');
if (totalItems > 0) {
    progressContainer.style.display = 'block';
    const percent = Math.round((checkedItems / totalItems) * 100);
    document.getElementById('packing-bar').style.width = percent + '%';
    document.getElementById('packing-percent').innerText = `${checkedItems} / ${totalItems} (${percent}%)`;
} else {
    progressContainer.style.display = 'none';
}
function clearCheckedItems() {
    if(confirm("ç¢ºå®šè¦æ¸…é™¤æ‰€æœ‰å·²å‹¾é¸é …ç›®å—ï¼Ÿ")) {
        categorizedPack.forEach(cat => cat.items = cat.items.filter(item => !item.checked));
        renderPackList();
    }
}


    localStorage.setItem('trip_pack_cat', JSON.stringify(categorizedPack));
}
// 1. çµ±ä¸€çš„åˆå§‹åŒ–å‡½æ•¸
function initializePage() {
    console.log("é é¢åˆå§‹åŒ–ä¸­...");
    // é‡æ–°æŠ“å–è³‡æ–™
    expenses = JSON.parse(localStorage.getItem('trip_v2026')) || [];
    categorizedPack = JSON.parse(localStorage.getItem('trip_pack_cat')) || [];

    // åŸ·è¡Œæ¸²æŸ“
    if (typeof render === "function") render();
    if (typeof renderPackList === "function") renderPackList();
}

// ğŸ”„ åŒ¯å…¥åŒæ­¥ä»£ç¢¼
function importData() {
    const code = prompt("è«‹è²¼ä¸Šæœ‹å‹å‚³çµ¦ä½ çš„åŒæ­¥ä»£ç¢¼ï¼š");
    if (!code) return;

    try {
        const decoded = JSON.parse(decodeURIComponent(atob(code)));

        // è¦†è“‹ localStorage
        if (decoded.favorites) localStorage.setItem('trip_favorites', JSON.stringify(decoded.favorites));
        if (decoded.packing) localStorage.setItem('trip_pack_cat', JSON.stringify(decoded.packing));
        if (decoded.expenses) localStorage.setItem('trip_v2026', JSON.stringify(decoded.expenses));

        alert('ğŸš€ åŒæ­¥æˆåŠŸï¼å³å°‡æ›´æ–°ç•«é¢ã€‚');

        // åˆ·æ–°ç•«é¢ï¼Œé‡æ–°æ¸²æŸ“æ”¶è—æ¸…å–®
        favorites = decoded.favorites || [];
        renderFavorites();
        // é€™è£¡å¯ä¾éœ€è¦å‘¼å« renderPacking()ã€renderExpenses() ç­‰åˆ·æ–°ç•«é¢å‡½æ•¸
    } catch (e) {
        console.error(e);
        alert('âŒ ä»£ç¢¼ç„¡æ•ˆï¼Œè«‹ç¢ºä¿å®Œæ•´è¤‡è£½ã€‚');
    }
}

// ğŸ”„ åŒ¯å‡ºåŒæ­¥ä»£ç¢¼
function exportData() {
    try {
        const data = {
            favorites: JSON.parse(localStorage.getItem('trip_favorites')) || [],
            packing: JSON.parse(localStorage.getItem('trip_pack_cat')) || [],
            expenses: JSON.parse(localStorage.getItem('trip_v2026')) || []
        };

        if (!data.favorites.length && !data.packing.length && !data.expenses.length) {
            alert('ç›®å‰æ²’æœ‰è³‡æ–™å¯åŒ¯å‡ºå–”ï¼');
            return;
        }

        const code = btoa(encodeURIComponent(JSON.stringify(data)));

        if (navigator.clipboard && navigator.clipboard.writeText) {
            navigator.clipboard.writeText(code).then(() => {
                alert('âœ… åŒæ­¥ä»£ç¢¼å·²è¤‡è£½ï¼Œè«‹å‚³é€çµ¦æœ‹å‹è²¼ä¸Šã€‚');
            }).catch(() => fallbackCopy(code));
        } else {
            fallbackCopy(code);
        }
    } catch (err) {
        alert("åŒ¯å‡ºå¤±æ•—ï¼š" + err);
    }
}
// --- æ”¶è—æ¸…å–® ---
let favorites = JSON.parse(localStorage.getItem('trip_favorites')) || [];

// --- å»ºç«‹æ”¶è—ç‰©ä»¶ ---
function createFavorite({ title, category = "å‚™æ¡ˆ" }) {
    return {
        id: Date.now(),
        title,
        category,
        note: "",
        items: [], // åœ°é»æ¸…å–®
        createdAt: new Date().toISOString()
    };
}

// --- å»ºç«‹åœ°é»ç‰©ä»¶ ---
function createItem({ name, links = [], note = "" }) {
    return {
        id: Date.now(),
        name,
        links,
        note,
        tempMark: false // ğŸ”– è‡¨æ™‚æ±ºç­–æ¨™è¨˜
    };
}

// --- å„²å­˜åˆ° localStorage ---
function saveFavorites() {
    localStorage.setItem('trip_favorites', JSON.stringify(favorites));
}

// --- æ¸²æŸ“é ‚éƒ¨è‡¨æ™‚æ¨™è¨˜å€ ---
function renderTopMarked() {
    const topContainer = document.getElementById('fav-top-list');
    topContainer.innerHTML = '';
    favorites.forEach(fav => {
        fav.items.filter(i => i.tempMark).forEach(item => {
            const div = document.createElement('div');
            div.className = "card-custom mb-1 p-2 bg-warning";
            div.innerText = `${fav.title} â†’ ${item.name}`;
            topContainer.appendChild(div);
        });
    });
}

// --- æ¸²æŸ“é ‚éƒ¨è‡¨æ™‚æ¨™è¨˜å€ ---
function renderTopMarked() {
    const topContainer = document.getElementById('fav-top-list');
    topContainer.innerHTML = '';
    favorites.forEach(fav => {
        fav.items.filter(i => i.tempMark).forEach(item => {
            const div = document.createElement('div');
            div.className = "card-custom mb-1 p-2 bg-warning d-flex justify-content-between align-items-center";

            const textSpan = document.createElement('span');
            textSpan.innerText = `${fav.title} â†’ ${item.name}`;
            div.appendChild(textSpan);

            // ğŸ”– å–æ¶ˆæ¨™è¨˜æŒ‰éˆ•
            const markBtn = document.createElement('button');
            markBtn.className = "btn btn-sm btn-warning ms-2";
            markBtn.innerText = "å–æ¶ˆæ¨™è¨˜";
            markBtn.onclick = () => {
                item.tempMark = false;
                saveFavorites();
                renderFavorites();
                renderTopMarked();
            };
            div.appendChild(markBtn);

            topContainer.appendChild(div);
        });
    });
}

// --- æ¸²æŸ“æ”¶è—åˆ—è¡¨ ---
function renderFavorites() {
    const container = document.getElementById('fav-list-container');
    container.innerHTML = '';

    if(favorites.length === 0) {
        container.innerHTML = `<div class="text-center text-muted py-3">å°šç„¡æ”¶è—é …ç›®</div>`;
        return;
    }

    favorites.forEach(fav => {
        const card = document.createElement('div');
        card.className = "card-custom mb-2 p-2 border";

        // å¤§æ¨™é¡Œ + å±•é–‹æŒ‰éˆ•
        const header = document.createElement('div');
        header.className = "d-flex justify-content-between align-items-center";
        const titleSpan = document.createElement('span');
        titleSpan.innerText = `${fav.title} [${fav.category}]`;
        header.appendChild(titleSpan);

        const btnGroup = document.createElement('div');

        // åˆªé™¤æ”¶è—
        const delBtn = document.createElement('button');
        delBtn.className = "btn btn-sm btn-outline-danger";
        delBtn.innerText = "ğŸ—‘ï¸";
        delBtn.onclick = () => { removeFavorite(fav.id); };

        // ç·¨è¼¯å¤§æ¨™é¡Œ
        const editBtn = document.createElement('button');
        editBtn.className = "btn btn-sm btn-outline-secondary me-1";
        editBtn.innerText = "âœï¸";
        editBtn.onclick = () => {
            const newTitle = prompt("ç·¨è¼¯æ¨™é¡Œ", fav.title);
            const newCategory = prompt("ç·¨è¼¯åˆ†é¡", fav.category);
            if(newTitle) fav.title = newTitle;
            if(newCategory) fav.category = newCategory;
            saveFavorites();
            renderFavorites();
        };

        btnGroup.appendChild(editBtn);
        btnGroup.appendChild(delBtn);

        // å±•é–‹/æ”¶åˆ
        const toggleBtn = document.createElement('button');
        toggleBtn.className = "btn btn-sm btn-outline-secondary ms-1";
        toggleBtn.innerText = "ğŸ”½";
        btnGroup.appendChild(toggleBtn);

        header.appendChild(btnGroup);
        card.appendChild(header);

        // åœ°é»æ¸…å–®å€
        const itemList = document.createElement('div');
        itemList.className = "mt-2";
        itemList.style.display = "none"; // åˆå§‹æ”¶åˆ
        fav.items.forEach(item => {
            const itemDiv = document.createElement('div');
            itemDiv.className = "border p-1 mb-1 position-relative";

            // âŒ åˆªé™¤ç´°é …æŒ‰éˆ•
            const removeItemBtn = document.createElement('button');
            removeItemBtn.className = "btn btn-sm btn-danger position-absolute";
            removeItemBtn.style.top = "5px";
            removeItemBtn.style.right = "5px";
            removeItemBtn.innerText = "âŒ";
            removeItemBtn.onclick = () => {
                fav.items = fav.items.filter(i => i.id !== item.id);
                saveFavorites();
                renderFavorites();
            };
            // ç·¨è¼¯ç´°é …
            const editItemBtn = document.createElement('button');
            editItemBtn.className = "btn btn-sm btn-secondary position-absolute";
            editItemBtn.style.top = "5px";
            editItemBtn.style.right = "40px"; // æ”¾åœ¨åˆªé™¤å‰æ–¹
            editItemBtn.innerText = "âœï¸";
            editItemBtn.onclick = () => {
                const newName = prompt("ç·¨è¼¯åœ°é»åç¨±", item.name);
                const newLinks = prompt("ç·¨è¼¯é€£çµï¼ˆç”¨ | åˆ†éš”ï¼‰", item.links.join(" | "));
                const newNote = prompt("ç·¨è¼¯å‚™è¨»", item.note);
                if(newName) item.name = newName;
                if(newLinks) item.links = newLinks.split("|").map(l => l.trim());
                if(newNote !== null) item.note = newNote; // å…è¨±æ¸…ç©º
                saveFavorites();
                renderFavorites();
            };

            itemDiv.appendChild(editItemBtn);
            itemDiv.appendChild(removeItemBtn);
            // åœ°é»åç¨±
            const nameSpan = document.createElement('span');
            nameSpan.innerText = item.name;
            itemDiv.appendChild(nameSpan);

            // é€£çµ
            if(item.links.length > 0) {
                const linkText = document.createElement('div');
                linkText.className = "small";
                linkText.innerHTML = item.links.map(l => `<a href="${l}" target="_blank">${l}</a>`).join(" | ");
                itemDiv.appendChild(linkText);
            }

            // å‚™è¨»
            if(item.note) {
                const noteDiv = document.createElement('div');
                noteDiv.className = "small text-muted";
                noteDiv.innerText = item.note;
                itemDiv.appendChild(noteDiv);
            }

            // ğŸ”– è‡¨æ™‚æ¨™è¨˜æŒ‰éˆ•
            const markBtn = document.createElement('button');
            markBtn.className = "btn btn-sm btn-warning mt-1";
            markBtn.innerText = item.tempMark ? "å–æ¶ˆæ¨™è¨˜" : "ğŸ”– æ¨™è¨˜";
            markBtn.onclick = () => {
                item.tempMark = !item.tempMark;
                saveFavorites();
                renderFavorites();
                renderTopMarked();
            };
            itemDiv.appendChild(markBtn);

            itemList.appendChild(itemDiv);
        });

        // æ–°å¢åœ°é»æŒ‰éˆ•
        const addItemBtn = document.createElement('button');
        addItemBtn.className = "btn btn-sm btn-primary mt-1";
        addItemBtn.innerText = "â• æ–°å¢åœ°é»";
        addItemBtn.onclick = () => addItemPrompt(fav.id);
        itemList.appendChild(addItemBtn);

        card.appendChild(itemList);

        // åˆ‡æ›å±•é–‹/æ”¶åˆ
        toggleBtn.onclick = () => {
            itemList.style.display = itemList.style.display === "none" ? "block" : "none";
        };

        container.appendChild(card);
    });

    renderTopMarked();
}
// --- æ–°å¢å¤§æ¨™é¡Œæ”¶è— ---
function addFavoritePrompt() {
    const title = prompt("è¼¸å…¥æ”¶è—å¤§æ¨™é¡Œ");
    if(!title) return;
    const category = prompt("åˆ†é¡æ¨™ç±¤(å¯ç©ºç™½, ä¾‹å¦‚é›¨å‚™)") || "å‚™æ¡ˆ";

    const fav = createFavorite({ title, category });
    favorites.push(fav);
    saveFavorites();
    renderFavorites();
}

// --- æ–°å¢åœ°é» ---
function addItemPrompt(favId) {
    const fav = favorites.find(f => f.id === favId);
    if(!fav) return;

    const name = prompt("åœ°é»åç¨± (å¿…å¡«)");
    if(!name) return;

    const linksRaw = prompt("é€£çµ (å¯ç©ºç™½ï¼Œå¤šå€‹ç”¨é€—è™Ÿåˆ†éš”)") || "";
    const links = linksRaw.split(",").map(s => s.trim()).filter(s => s);

    const note = prompt("å‚™è¨» (å¯ç©ºç™½)") || "";

    const item = createItem({ name, links, note });
    fav.items.push(item);
    saveFavorites();
    renderFavorites();
}

// --- åˆªé™¤æ”¶è— ---
function removeFavorite(id) {
    favorites = favorites.filter(f => f.id !== id);
    saveFavorites();
    renderFavorites();
}

// --- åˆå§‹æ¸²æŸ“ ---
renderFavorites();
// 4. åªæœ‰ä¸€å€‹ onloadï¼Œç¢ºä¿æ‰€æœ‰äº‹æƒ…éƒ½åœ¨é€™è£¡ç™¼ç”Ÿ
window.onload = function() {
    const savedTheme = localStorage.getItem('trip_theme');
    if (savedTheme) {
        document.documentElement.setAttribute('data-theme', savedTheme);
    updateThemeIcon(savedTheme);
    }
    initializePage();
    updateClocks(); // ç¢ºä¿é é¢ä¸€æ‰“é–‹å°±é¡¯ç¤ºæ™‚é–“
};
initScrollSpy();
function fallbackCopy(text) {
    const textarea = document.createElement("textarea");
    textarea.value = text;
    document.body.appendChild(textarea);
    textarea.select();
    try {
        document.execCommand("copy");
        alert("âœ… åŒæ­¥ä»£ç¢¼å·²è¤‡è£½ï¼ˆå‚™ç”¨æ¨¡å¼ï¼‰");
    } catch (e) {
        alert("âŒ ç„¡æ³•è‡ªå‹•è¤‡è£½ï¼Œè«‹æ‰‹å‹•è¤‡è£½");
        prompt("è«‹æ‰‹å‹•è¤‡è£½ä»¥ä¸‹ä»£ç¢¼ï¼š", text);
    }
    document.body.removeChild(textarea);
}
function initScrollSpy() {
    const sections = document.querySelectorAll('.day-content[data-day]');
    const tabs = document.querySelectorAll('.day-tab');

    const observer = new IntersectionObserver(entries => {
        entries.forEach(entry => {
            if (entry.isIntersecting) {
                const dayId = entry.target.dataset.day;

                // åˆ‡æ› tab é«˜äº®
                tabs.forEach(t => t.classList.remove('active'));
                const activeTab = document.querySelector(
                    `.day-tab[onclick*="'${dayId}'"]`
                );
                if (activeTab) activeTab.classList.add('active');
            }
        });
    }, {
        rootMargin: '-40% 0px -50% 0px', // é‡é»ï¼šæ±ºå®šä½•æ™‚ç®—ã€Œé€²å…¥ã€
        threshold: 0
    });

    sections.forEach(sec => observer.observe(sec));
}
function toggleTheme() {
function updateThemeIcon(theme) {
    const btn = document.getElementById('themeBtn');
    if (!btn) return;

    // ç·šæ¢é¢¨ iconï¼ˆé emojiï¼‰
    btn.textContent = theme === 'dark' ? 'â˜€ï¸' : 'â˜¾';
}
    const html = document.documentElement;
    const current = html.getAttribute('data-theme') || 'light';
    const next = current === 'dark' ? 'light' : 'dark';

    html.setAttribute('data-theme', next);
    localStorage.setItem('trip_theme', next);

    updateThemeIcon(next);
}
function updateThemeIcon(theme) {
    const btn = document.getElementById('themeBtn');
    if (!btn) return;

    btn.textContent = theme === 'dark' ? 'â˜€ï¸' : 'â˜¾';
}
// ä½å®¿è³‡æ–™åº« (è«‹æ ¹æ“šæ‚¨çš„å¯¦éš›é£¯åº—åç¨±èˆ‡ Google Map é€£çµä¿®æ”¹)
const hotelData = {
    "911": { name: "Hotel Liegeplatz 13 Kiel by Premiere Classe", map: "https://maps.app.goo.gl/uiViyTyUQAfHDNbq6" },
    "912": { name: "MSC Cruise Ship", map: "https://maps.app.goo.gl/yAHd1n7yvGv2XG7m8" },
    "919": { name: "Barabas Luzern", map: "https://maps.app.goo.gl/NdmS1o8y9ZsDfiYu5" },
    "920": { name: "Hotel Victoria Lauberhorn Wengen", map: "https://maps.app.goo.gl/JUk59ZPRiiRCN5Aw9" },
    "921": { name: "Hotel Victoria Lauberhorn Wengen", map: "https://maps.app.goo.gl/JUk59ZPRiiRCN5Aw9" },
    "922": { name: "Hotel Victoria Lauberhorn Wengen", map: "https://maps.app.goo.gl/JUk59ZPRiiRCN5Aw9" },
    "923": { name: "Zermatt Hotel Alpina", map: "https://maps.app.goo.gl/vPqfrLinN6M45mbN8" },
    "924": { name: "Zermatt Hotel Alpina", map: "https://maps.app.goo.gl/vPqfrLinN6M45mbN8" },
    "925": { name: "Zermatt Hotel Alpina", map: "https://maps.app.goo.gl/vPqfrLinN6M45mbN8" },
    "926": { name: "Hostel INN PETRELLA Milan", map: "https://maps.app.goo.gl/E8gig159c8U69n2x9" },
    "927": { name: "Milan Malpensa Airport MXP", map: "https://maps.app.goo.gl/PuzkC7L5KWpmE93v5" },
    "928": { name: "Home", map: "https://maps.app.goo.gl/UNuPB1CaheDYPV9h9" },
    
};
// ã€æ–°å¢æŒ‡ä»¤ã€‘ï¼šå»ºç«‹ä¸€å€‹çµ±ä¸€çš„åˆ·æ–°åˆ¤å®šå·¥å…·
function refreshHotelBar() {
    const hotelBar = document.getElementById('hotel-bar');
    const hotelNameEl = document.getElementById('hotel-name');
    const hotelLinkEl = document.getElementById('hotel-link');
    if (!hotelBar) return;

    // 1. æª¢æŸ¥è¡Œç¨‹åˆ†é æ˜¯å¦ç‚º active
    const isItineraryActive = document.getElementById('itinerary').classList.contains('active');

    // 2. ç²å–ç›®å‰é¸ä¸­çš„æ—¥æœŸ
    const activeTab = document.querySelector('.day-tab.active');
    const dayId = activeTab ? activeTab.getAttribute('onclick').match(/'([^']+)'/)[1] : 'all';

    // 3. åˆ¤å®šé¡¯ç¤ºæˆ–éš±è—
    if (isItineraryActive && dayId !== 'all' && hotelData[dayId]) {
        hotelNameEl.innerText = hotelData[dayId].name;
        hotelLinkEl.href = hotelData[dayId].map;
        hotelBar.style.setProperty('display', 'flex', 'important');
    } else {
        hotelBar.style.setProperty('display', 'none', 'important');
    }
}
// ä¿®æ”¹åŸæœ‰çš„ switchDay å‡½æ•¸
// ã€ä¿®æ”¹æŒ‡ä»¤ã€‘ï¼šè®“ switchDay ç›´æ¥èª¿ç”¨å‰›å‰›å»ºç«‹çš„å·¥å…·
const originalSwitchDay = switchDay;
switchDay = function(dayId, el) {
    originalSwitchDay(dayId, el); 
    refreshHotelBar(); // ç›´æ¥åŸ·è¡Œå‰›å¯«å¥½çš„å·¥å…·
};
document.querySelectorAll('.time-header').forEach(header => {
    header.addEventListener('click', () => {
        const item = header.closest('.time-item');
        item.classList.toggle('open');
    });
});
// ğŸ—“ï¸ é¡¯ç¤ºä»Šå¤©æ—¥æœŸåœ¨æŒ‰éˆ•ä¸Šï¼ˆæ­æ´²æ™‚é–“ï¼‰
(function updateTodayLabel() {
    const now = new Date();

    const euMonth = new Intl.DateTimeFormat('en-US', {
        month: 'numeric',
        timeZone: 'Europe/Berlin'
    }).format(now);

    const euDay = new Intl.DateTimeFormat('en-US', {
        day: 'numeric',
        timeZone: 'Europe/Berlin'
    }).format(now);

    const label = document.getElementById('todayDate');
    if (label) {
        label.textContent = `${euMonth}/${euDay}`;
    }
})();
function jumpToToday() {
    const now = new Date();
    const m = now.getMonth() + 1;
    const d = now.getDate();
    const y = now.getFullYear();

    // åˆ¤æ–·æ˜¯å¦åœ¨ 2026 å¹´ 9 æœˆ 10 æ—¥è‡³ 28 æ—¥ä¹‹é–“
    if (y === 2026 && m === 9 && d >= 10 && d <= 28) {
        const dayId = '9' + d; // ç”Ÿæˆ ID å¦‚ 910, 911...
        
        // 1. å¼·åˆ¶åˆ‡æ›å›ã€Œè¡Œç¨‹ã€å¤§åˆ†é 
        const itineraryNav = document.querySelector('.nav-item[onclick*="itinerary"]');
        if (typeof switchTab === 'function') {
            switchTab('itinerary', itineraryNav);
        }

// 2. æ‰¾åˆ°å°æ‡‰æ—¥æœŸçš„ Tab
        const targetTab = document.querySelector(`.day-tab[onclick*="'${dayId}'"]`);
        
        if (targetTab) {
            // A. è§¸ç™¼å…§å®¹åˆ‡æ›
            targetTab.click(); 
            
            // B. åŒæ­¥æ²å‹•ä¸Šæ–¹å°è¦½åˆ—ï¼šè®“ç›®æ¨™ Tab æ»¾å‹•åˆ°å®¹å™¨çš„æœ€å·¦å´
            targetTab.scrollIntoView({
                behavior: 'smooth', // å¹³æ»‘æ²å‹•
                inline: 'start',    // å°é½Šåˆ°èµ·å§‹ä½ç½® (æœ€å·¦å´)
                block: 'nearest'    // å‚ç›´æ–¹å‘ä¿æŒä¸å‹•
            });

            // C. è¦–è¦ºå›é¥‹ï¼šæ»¾å‹•é é¢åˆ°é ‚éƒ¨
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }
    }
}
// é é¢åŠ è¼‰å¾Œè‡ªå‹•é¡¯ç¤ºæ—¥æœŸæ–‡å­—
document.addEventListener('DOMContentLoaded', () => {
    const now = new Date();
    const todayBtn = document.getElementById('todayBtn');
    if (now.getMonth() + 1 === 9) {
        todayBtn.innerText = `9/${now.getDate()}`;
    }
});
</script>
<div id="hotel-bar" class="accommodation-bar">
    <div>
        <small class="text-muted d-block" style="font-size: 0.65rem;">ä»Šæ™šä½å®¿</small>
        <span id="hotel-name" class="hotel-name">è¼‰å…¥ä¸­...</span>
    </div>
    <a id="hotel-link" href="#" target="_blank" class="btn-map">
        <i class="fas fa-map-marker-alt"></i> 
    </a>
</div>
</body>
</html>
